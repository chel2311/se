<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DBMS基本概念学習ツール - タブ形式インターフェース</title>
    <style>
        :root {
            --primary-color: #005BAB;
            --secondary-color: #FF961C;
            --light-blue: #E0EEF9;
            --medium-blue: #4D8BC9;
            --neutral-grey: #F5F5F5;
            --dark-grey: #616161;
            --text-dark: #333333;
            --text-light: #FFFFFF;
            --success-color: #4CAF50;
            --warning-color: #FFC107;
            --danger-color: #F44336;
            --info-color: #2196F3;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: Meiryo, "Hiragino Kaku Gothic Pro", system-ui, sans-serif;
            margin: 0;
            padding: 0;
            color: var(--text-dark);
            background-color: #f8f9fa;
            line-height: 1.6;
        }
        
        /* ヘッダー */
        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--medium-blue) 100%);
            color: var(--text-light);
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            position: relative;
        }
        
        /* ポータルボタン */
        .portal-button {
            position: absolute;
            left: 2rem;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-light);
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-size: 0.9rem;
        }
        
        .portal-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .portal-button::before {
            content: '←';
            margin-right: 0.5rem;
            font-weight: bold;
        }
        
        /* モバイル対応 */
        @media (max-width: 768px) {
            .portal-button {
                position: static;
                transform: none;
                display: inline-block;
                margin-bottom: 1rem;
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
            
            header {
                padding: 1.5rem 1rem;
            }
        }
        
        h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .subtitle {
            margin-top: 0.5rem;
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        /* コンテナ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* タブインターフェース */
        .tab-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        /* タブヘッダー */
        .tab-header {
            display: flex;
            flex-wrap: wrap;
            background: var(--neutral-grey);
            border-bottom: 3px solid var(--primary-color);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
        }
        
        .tab-header::-webkit-scrollbar {
            height: 6px;
        }
        
        .tab-header::-webkit-scrollbar-track {
            background: var(--neutral-grey);
        }
        
        .tab-header::-webkit-scrollbar-thumb {
            background: var(--medium-blue);
            border-radius: 3px;
        }
        
        /* タブボタン */
        .tab-button {
            padding: 1rem 1.5rem;
            border: none;
            background: transparent;
            color: var(--text-dark);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .tab-button:hover {
            background: var(--light-blue);
            color: var(--primary-color);
            transform: translateY(-2px);
        }
        
        .tab-button.active {
            background: white;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .tab-button::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--secondary-color);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .tab-button.active::after {
            transform: scaleX(1);
        }
        
        /* タブアイコン */
        .tab-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 0.5rem;
            vertical-align: middle;
            font-size: 1rem;
        }
        
        /* タブコンテンツ */
        .tab-content {
            padding: 2.5rem;
            min-height: 500px;
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* セクションスタイル */
        .section {
            margin-bottom: 2rem;
        }
        
        h2 {
            color: var(--primary-color);
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.8rem;
        }
        
        h3 {
            color: var(--primary-color);
            margin-top: 2rem;
        }
        
        /* 概念説明ボックス */
        .concept-box {
            background: linear-gradient(to right, var(--light-blue), white);
            padding: 2rem;
            border-radius: 12px;
            margin: 1.5rem 0;
            border-left: 5px solid var(--primary-color);
        }
        
        /* テーブルスタイル */
        .data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin: 1.5rem 0;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .data-table th {
            background: var(--primary-color);
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
        }
        
        .data-table td {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid #e0e0e0;
            background: white;
            transition: all 0.3s ease;
        }
        
        .data-table tr:hover td {
            background: var(--light-blue);
            transform: translateX(3px);
        }
        
        /* ツールチップ - 改良版 */
        .tooltip {
            position: relative;
            display: inline-block;
            color: var(--primary-color);
            text-decoration: underline;
            text-decoration-style: dotted;
            cursor: help;
            font-weight: 600;
            transition: color 0.3s ease;
        }
        
        .tooltip:hover {
            color: var(--secondary-color);
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 280px;
            max-width: calc(100vw - 40px);
            min-width: 200px;
            background: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 12px;
            position: fixed;
            z-index: 999999;
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: normal;
            font-size: 0.85rem;
            line-height: 1.4;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            pointer-events: none;
            white-space: normal;
            word-wrap: break-word;
            box-sizing: border-box;
        }
        
        /* 矢印 */
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }
        
        /* テーブル内の最初の列 */
        td:first-child .tooltip .tooltiptext,
        td:nth-child(2) .tooltip .tooltiptext {
            left: -10px;
            transform: translateX(0);
        }
        
        td:first-child .tooltip .tooltiptext::after,
        td:nth-child(2) .tooltip .tooltiptext::after {
            left: 30px;
        }
        
        /* テーブル内の最後の列 */
        td:last-child .tooltip .tooltiptext,
        td:nth-last-child(2) .tooltip .tooltiptext {
            left: auto;
            right: -10px;
            transform: translateX(0);
        }
        
        td:last-child .tooltip .tooltiptext::after,
        td:nth-last-child(2) .tooltip .tooltiptext::after {
            left: auto;
            right: 30px;
        }
        
        /* 通常のコンテンツ内のツールチップ */
        p .tooltip .tooltiptext,
        li .tooltip .tooltiptext,
        .concept-box .tooltip .tooltiptext {
            width: 320px;
            max-width: calc(100vw - 20px);
            left: 50%;
            transform: translateX(-50%);
        }
        
        /* 画面の右端に近い場合 */
        .concept-box:last-child .tooltip .tooltiptext {
            left: auto;
            right: 0;
            transform: translateX(0);
        }
        
        .concept-box:last-child .tooltip .tooltiptext::after {
            left: auto;
            right: 30px;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* モバイル対応 */
        @media (max-width: 768px) {
            .tooltip .tooltiptext {
                width: 90vw;
                max-width: 300px;
                left: 50%;
                transform: translateX(-50%);
                font-size: 0.8rem;
                padding: 10px;
            }
            
            /* モバイルでは常に中央に表示 */
            td .tooltip .tooltiptext {
                position: fixed;
                bottom: auto;
                top: 20%;
                left: 5vw !important;
                right: 5vw !important;
                width: auto !important;
                transform: none !important;
            }
        }
        
        /* コードハイライト */
        .code-highlight {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        .keyword {
            color: #0000ff;
            font-weight: bold;
        }
        
        .string {
            color: #008000;
        }
        
        .comment {
            color: #808080;
            font-style: italic;
        }
        
        /* SVG図解コンテナ */
        .diagram-container {
            display: flex;
            justify-content: center;
            margin: 2rem 0;
            overflow-x: auto;
            max-width: 100%;
        }
        
        .svg-diagram {
            width: 100%;
            height: auto;
            min-width: 700px;
        }
        
        /* ボタンスタイル */
        .execute-btn {
            background: var(--success-color);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }
        
        .execute-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76,175,80,0.3);
        }
        
        .animation-btn {
            background: var(--info-color);
            color: white;
            border: none;
            padding: 0.6rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0.5rem;
        }
        
        .animation-btn:hover {
            background: #1976D2;
            transform: scale(1.05);
        }
        
        /* 例題カード */
        .example-card {
            background: var(--light-blue);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .example-card:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,91,171,0.2);
        }
        
        .example-card::after {
            content: '▶';
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        /* SQLエディタ */
        .sql-editor {
            background: #f5f5f5;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .sql-input {
            width: 100%;
            min-height: 100px;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s ease;
        }
        
        .sql-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0,91,171,0.2);
        }
        
        /* 結果表示エリア */
        .result-area {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: 8px;
            background: #f9f9f9;
            border: 1px solid #e0e0e0;
            min-height: 100px;
        }
        
        .result-success {
            border-color: var(--success-color);
            background: #e8f5e9;
        }
        
        .result-error {
            border-color: var(--danger-color);
            background: #ffebee;
        }
        
        /* レスポンシブ対応 */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .tab-button {
                padding: 0.8rem 1rem;
                font-size: 0.85rem;
            }
            
            .tab-content {
                padding: 1.5rem;
            }
            
            .tooltip .tooltiptext {
                width: 250px;
                margin-left: -125px;
            }
        }
        
        /* プログレスインジケータ */
        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--neutral-grey);
            border-radius: 15px;
            overflow: hidden;
            margin: 1rem 0;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--medium-blue), var(--primary-color));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }
        
        /* トランザクションデモ */
        .transaction-demo {
            background: #f5f5f5;
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
        }
        
        .transaction-step {
            background: white;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .transaction-step.active {
            border-color: var(--primary-color);
            transform: translateX(10px);
            box-shadow: 0 4px 12px rgba(0,91,171,0.2);
        }
        
        .transaction-step.success {
            border-color: var(--success-color);
            background: #e8f5e9;
        }
        
        .transaction-step.error {
            border-color: var(--danger-color);
            background: #ffebee;
        }
        
        /* アニメーション用スタイル */
        .highlight-row {
            animation: highlightRow 2s ease;
        }
        
        @keyframes highlightRow {
            0% { background-color: white; }
            50% { background-color: var(--warning-color); }
            100% { background-color: var(--light-blue); }
        }
        
        .highlight-cell {
            animation: highlightCell 1s ease;
        }
        
        @keyframes highlightCell {
            0% { background-color: var(--secondary-color); color: white; }
            100% { background-color: white; }
        }
        
        /* 構造説明のハイライト */
        .structure-highlight {
            stroke: var(--secondary-color) !important;
            stroke-width: 3px !important;
            filter: drop-shadow(0 0 10px rgba(255, 150, 28, 0.5));
        }
        
        .structure-fade {
            opacity: 0.3;
            transition: opacity 0.5s ease;
        }
        
        /* 階層構造アニメーション用 */
        .data-cell {
            transition: all 0.5s ease;
        }
        
        .data-cell.highlight {
            fill: var(--secondary-color);
            opacity: 0.5;
        }
        
        .data-record rect {
            transition: all 0.5s ease;
        }
        
        .data-record.highlight > rect:first-child {
            fill: var(--light-blue) !important;
            stroke: var(--primary-color) !important;
            stroke-width: 2px !important;
        }
        
        .column-highlight {
            transition: all 0.5s ease;
        }
        
        .column-highlight.active {
            fill: var(--secondary-color);
            opacity: 0.5;
        }
        
        /* SELECT文フローアニメーション用 */
        .select-record {
            transition: all 0.5s ease;
        }
        
        .select-record.fade {
            opacity: 0.3;
        }
        
        .select-record.highlight > rect:first-child {
            fill: var(--warning-color) !important;
            stroke: var(--warning-color) !important;
            stroke-width: 3px !important;
        }
        
        .select-record.match > rect:first-child {
            fill: var(--light-blue) !important;
            stroke: var(--primary-color) !important;
            stroke-width: 3px !important;
        }
        
        #where-condition, #select-columns, #result-area {
            transition: opacity 0.5s ease;
        }
        
        /* ステップインジケーター */
        #step-box {
            transition: all 0.5s ease;
        }
        
        #step-box.step2 {
            fill: #FFEBEE;
            stroke: var(--danger-color);
        }
        
        #step-box.step3 {
            fill: #E8F5E9;
            stroke: var(--success-color);
        }
        
        #step-box.step4 {
            fill: #FFF3E0;
            stroke: var(--secondary-color);
        }
        
        #step-box.step5 {
            fill: #E8F5E9;
            stroke: var(--success-color);
        }
        
        /* 段階的学習エリア */
        .step-learning {
            background: #f9f9f9;
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem 0;
        }
        
        .learning-step {
            background: white;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            opacity: 0.5;
            transition: all 0.3s ease;
        }
        
        .learning-step.active {
            opacity: 1;
            border-color: var(--primary-color);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0,91,171,0.2);
        }
        
        .learning-step.completed {
            opacity: 1;
            border-color: var(--success-color);
            background: #e8f5e9;
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="portal-button">ポータルへ戻る</a>
        <h1>🗄️ DBMS基本概念学習ツール</h1>
        <p class="subtitle">データベースの基礎を図解とシミュレータで楽しく学ぼう！</p>
    </header>
    
    <div class="container">
        <div class="tab-container">
            <!-- タブヘッダー -->
            <div class="tab-header">
                <button class="tab-button active" onclick="showTab('intro')">
                    <span class="tab-icon">📚</span>はじめに
                </button>
                <button class="tab-button" onclick="showTab('concepts')">
                    <span class="tab-icon">🏗️</span>基本概念
                </button>
                <button class="tab-button" onclick="showTab('sql-basics')">
                    <span class="tab-icon">💻</span>SQL基礎
                </button>
                <button class="tab-button" onclick="showTab('crud')">
                    <span class="tab-icon">🔧</span>CRUD操作
                </button>
                <button class="tab-button" onclick="showTab('where')">
                    <span class="tab-icon">🔍</span>WHERE句
                </button>
                <button class="tab-button" onclick="showTab('join')">
                    <span class="tab-icon">🔗</span>JOIN
                </button>
                <button class="tab-button" onclick="showTab('transaction')">
                    <span class="tab-icon">🔄</span>トランザクション
                </button>
                <button class="tab-button" onclick="showTab('data-types')">
                    <span class="tab-icon">📊</span>データ型
                </button>
                <button class="tab-button" onclick="showTab('stored-proc')">
                    <span class="tab-icon">⚙️</span>ストアドプロシージャ
                </button>
                <button class="tab-button" onclick="showTab('simulator')">
                    <span class="tab-icon">🎮</span>実践シミュレータ
                </button>
            </div>
            
            <!-- タブコンテンツ -->
            <!-- はじめに -->
            <div id="intro" class="tab-content active">
                <div class="section">
                    <h2>DBMSとは？</h2>
                    
                    <div class="concept-box">
                        <h3>データベース管理システム（DBMS）って何？</h3>
                        <p><span class="tooltip">DBMS<span class="tooltiptext">Database Management Systemの略。データベースを効率的に管理するためのソフトウェア。代表的なものにMySQL、PostgreSQL、Oracle、SQL Serverなどがある</span></span>（Database Management System）は、<strong>大量のデータを効率的に保存・管理・検索できるシステム</strong>です。</p>
                        
                        <p>例えば、Excelで顧客情報を管理している場合を考えてみましょう：</p>
                        <ul>
                            <li>😰 データが増えると動作が重くなる</li>
                            <li>😰 複数人で同時に編集すると競合が発生</li>
                            <li>😰 関連するデータを別シートで管理すると整合性が保てない</li>
                        </ul>
                        
                        <p>DBMSなら、これらの問題を解決できます！</p>
                        <ul>
                            <li>✅ 数百万件のデータも高速処理</li>
                            <li>✅ 複数人での同時アクセスも安全</li>
                            <li>✅ データの整合性を自動的に保証</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <svg class="svg-diagram" width="800" height="350" viewBox="0 0 800 350">
                            <text x="400" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#005BAB">ExcelとDBMSの比較</text>
                            
                            <!-- Excel側 -->
                            <g transform="translate(50, 60)">
                                <rect x="0" y="0" width="300" height="250" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                                <text x="150" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#4CAF50">Excel</text>
                                
                                <text x="20" y="60" font-size="14" fill="#333">👤 個人利用向け</text>
                                <text x="20" y="85" font-size="14" fill="#333">📊 数千件程度のデータ</text>
                                <text x="20" y="110" font-size="14" fill="#333">🔒 単純なロック機能</text>
                                <text x="20" y="135" font-size="14" fill="#333">📁 ファイル単位で管理</text>
                                <text x="20" y="160" font-size="14" fill="#333">🎯 手軽で直感的</text>
                                <text x="20" y="185" font-size="14" fill="#666">⚠️ データ量に限界あり</text>
                            </g>
                            
                            <!-- DBMS側 -->
                            <g transform="translate(450, 60)">
                                <rect x="0" y="0" width="300" height="250" rx="10" fill="#E0EEF9" stroke="#005BAB" stroke-width="2"/>
                                <text x="150" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#005BAB">DBMS</text>
                                
                                <text x="20" y="60" font-size="14" fill="#333">👥 チーム・企業向け</text>
                                <text x="20" y="85" font-size="14" fill="#333">💾 数百万件以上OK</text>
                                <text x="20" y="110" font-size="14" fill="#333">🔐 高度な同時実行制御</text>
                                <text x="20" y="135" font-size="14" fill="#333">🗄️ 複数テーブルで管理</text>
                                <text x="20" y="160" font-size="14" fill="#333">⚡ 高速検索・処理</text>
                                <text x="20" y="185" font-size="14" fill="#005BAB">✨ データの整合性保証</text>
                            </g>
                        </svg>
                    </div>
                    
                    <h3>システム構成</h3>
                    <div class="concept-box">
                        <p>DBMSは複数の層（レイヤー）で構成されており、それぞれが重要な役割を担っています。</p>
                    </div>
                    
                    <div class="diagram-container">
                        <svg class="svg-diagram" width="900" height="600" viewBox="0 0 900 600">
                            <text x="450" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#005BAB">DBMSシステム構成図</text>
                            
                            <!-- ユーザー層 -->
                            <g transform="translate(200, 60)">
                                <rect x="0" y="0" width="500" height="80" rx="10" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                                <text x="250" y="30" text-anchor="middle" font-size="18" font-weight="bold" fill="#4CAF50">ユーザー・アプリケーション層</text>
                                
                                <g transform="translate(50, 40)">
                                    <circle cx="0" cy="0" r="15" fill="#4CAF50"/>
                                    <text x="0" y="25" text-anchor="middle" font-size="12" fill="#333">開発者</text>
                                </g>
                                
                                <g transform="translate(150, 40)">
                                    <circle cx="0" cy="0" r="15" fill="#4CAF50"/>
                                    <text x="0" y="25" text-anchor="middle" font-size="12" fill="#333">アプリ</text>
                                </g>
                                
                                <g transform="translate(250, 40)">
                                    <circle cx="0" cy="0" r="15" fill="#4CAF50"/>
                                    <text x="0" y="25" text-anchor="middle" font-size="12" fill="#333">管理者</text>
                                </g>
                                
                                <g transform="translate(350, 40)">
                                    <circle cx="0" cy="0" r="15" fill="#4CAF50"/>
                                    <text x="0" y="25" text-anchor="middle" font-size="12" fill="#333">分析者</text>
                                </g>
                            </g>
                            
                            <!-- 矢印 -->
                            <line x1="450" y1="140" x2="450" y2="170" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                            <text x="480" y="160" font-size="14" fill="#666">SQL文</text>
                            
                            <!-- SQL処理層 -->
                            <g transform="translate(200, 170)">
                                <rect x="0" y="0" width="500" height="100" rx="10" fill="#E0EEF9" stroke="#005BAB" stroke-width="2"/>
                                <text x="250" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#005BAB">SQL処理エンジン</text>
                                
                                <rect x="20" y="40" width="140" height="40" rx="5" fill="white" stroke="#005BAB"/>
                                <text x="90" y="65" text-anchor="middle" font-size="12" fill="#333">Query Parser</text>
                                
                                <rect x="180" y="40" width="140" height="40" rx="5" fill="white" stroke="#005BAB"/>
                                <text x="250" y="65" text-anchor="middle" font-size="12" fill="#333">最適化エンジン</text>
                                
                                <rect x="340" y="40" width="140" height="40" rx="5" fill="white" stroke="#005BAB"/>
                                <text x="410" y="65" text-anchor="middle" font-size="12" fill="#333">実行エンジン</text>
                            </g>
                            
                            <!-- 矢印 -->
                            <line x1="450" y1="270" x2="450" y2="300" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                            
                            <!-- トランザクション管理層 -->
                            <g transform="translate(200, 300)">
                                <rect x="0" y="0" width="500" height="80" rx="10" fill="#FFF3E0" stroke="#FF961C" stroke-width="2"/>
                                <text x="250" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#FF961C">トランザクション管理</text>
                                
                                <rect x="20" y="35" width="100" height="30" rx="5" fill="white" stroke="#FF961C"/>
                                <text x="70" y="55" text-anchor="middle" font-size="11" fill="#333">同時実行制御</text>
                                
                                <rect x="140" y="35" width="100" height="30" rx="5" fill="white" stroke="#FF961C"/>
                                <text x="190" y="55" text-anchor="middle" font-size="11" fill="#333">ロック管理</text>
                                
                                <rect x="260" y="35" width="100" height="30" rx="5" fill="white" stroke="#FF961C"/>
                                <text x="310" y="55" text-anchor="middle" font-size="11" fill="#333">整合性保証</text>
                                
                                <rect x="380" y="35" width="100" height="30" rx="5" fill="white" stroke="#FF961C"/>
                                <text x="430" y="55" text-anchor="middle" font-size="11" fill="#333">ログ管理</text>
                            </g>
                            
                            <!-- 矢印 -->
                            <line x1="450" y1="380" x2="450" y2="410" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                            
                            <!-- ストレージ層 -->
                            <g transform="translate(200, 410)">
                                <rect x="0" y="0" width="500" height="100" rx="10" fill="#FFEBEE" stroke="#F44336" stroke-width="2"/>
                                <text x="250" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#F44336">ストレージエンジン</text>
                                
                                <rect x="20" y="40" width="140" height="40" rx="5" fill="white" stroke="#F44336"/>
                                <text x="90" y="65" text-anchor="middle" font-size="12" fill="#333">バッファ管理</text>
                                
                                <rect x="180" y="40" width="140" height="40" rx="5" fill="white" stroke="#F44336"/>
                                <text x="250" y="65" text-anchor="middle" font-size="12" fill="#333">インデックス管理</text>
                                
                                <rect x="340" y="40" width="140" height="40" rx="5" fill="white" stroke="#F44336"/>
                                <text x="410" y="65" text-anchor="middle" font-size="12" fill="#333">ファイル管理</text>
                            </g>
                            
                            <!-- 矢印 -->
                            <line x1="450" y1="510" x2="450" y2="540" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
                            
                            <!-- 物理ストレージ -->
                            <g transform="translate(350, 540)">
                                <rect x="0" y="0" width="200" height="40" rx="5" fill="#616161" stroke="#333" stroke-width="2"/>
                                <text x="100" y="25" text-anchor="middle" font-size="16" font-weight="bold" fill="white">💾 物理ストレージ</text>
                            </g>
                            
                            <!-- 矢印定義 -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>
            </div>
            
            <!-- 基本概念 -->
            <div id="concepts" class="tab-content">
                <div class="section">
                    <h2>基本概念 - Table、Record、Column</h2>
                    
                    <div class="concept-box">
                        <h3>データベースの基本構造を理解しよう</h3>
                        <p>データベースは、<span class="tooltip">Table（テーブル）<span class="tooltiptext">データを格納する表。Excelのシートのようなもの。関連するデータを行と列で整理して保存する</span></span>という表形式でデータを管理します。</p>
                        <ul>
                            <li><strong>Table（テーブル）</strong>：データを格納する表全体（Excelのシートに相当）</li>
                            <li><strong>Record（レコード）</strong>：表の1行分のデータ（Excelの行に相当）</li>
                            <li><strong>Column（カラム）</strong>：表の列、データの項目（Excelの列に相当）</li>
                            <li><strong>Cell（セル）</strong>：行と列が交差する場所の値</li>
                        </ul>
                    </div>
                    
                    <h3>階層構造</h3>
                    <div class="concept-box">
                        <p>DBMSは階層的な構造でデータを管理しています。大きな箱の中に小さな箱が入っているイメージです。</p>
                        <ul>
                            <li><strong>DBMS</strong>：データベース管理システム全体（一番外側の箱）</li>
                            <li><strong>Database</strong>：個別のデータベース（業務ごとに分けられた箱）</li>
                            <li><strong>Table</strong>：データを格納する表（データの種類ごとの表）</li>
                            <li><strong>Record/Column</strong>：表の行と列</li>
                            <li><strong>Cell</strong>：行と列が交差する場所の値</li>
                        </ul>
                    </div>
                    
                    <!-- 階層構造図 -->
                    <div class="diagram-container">
                        <svg class="svg-diagram" width="900" height="600" viewBox="0 0 900 600">
                            <text x="450" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#005BAB">DBMS階層構造</text>
                            
                            <!-- DBMS（最外側） -->
                            <g id="dbms-layer">
                                <rect x="50" y="60" width="800" height="500" rx="15" fill="#E0EEF9" stroke="#005BAB" stroke-width="3"/>
                                <text x="100" y="90" font-size="18" font-weight="bold" fill="#005BAB">DBMS（データベース管理システム）</text>
                                
                                <!-- Database層 -->
                                <g id="database-layer">
                                    <rect x="100" y="120" width="340" height="400" rx="10" fill="#FFF3E0" stroke="#FF961C" stroke-width="2"/>
                                    <text x="120" y="145" font-size="16" font-weight="bold" fill="#FF961C">Database: 人事管理DB</text>
                                    
                                    <!-- Table層 -->
                                    <g id="table-layer">
                                        <rect x="130" y="170" width="280" height="320" rx="8" fill="#F5F5F5" stroke="#4D8BC9" stroke-width="2"/>
                                        <text x="150" y="195" font-size="14" font-weight="bold" fill="#4D8BC9">Table: 社員テーブル</text>
                                        
                                        <!-- テーブル構造 -->
                                        <g transform="translate(150, 210)">
                                            <!-- ヘッダー（Columns） -->
                                            <rect x="0" y="0" width="240" height="30" fill="#4D8BC9" opacity="0.8"/>
                                            <line x1="60" y1="0" x2="60" y2="30" stroke="white" stroke-width="1"/>
                                            <line x1="120" y1="0" x2="120" y2="30" stroke="white" stroke-width="1"/>
                                            <line x1="180" y1="0" x2="180" y2="30" stroke="white" stroke-width="1"/>
                                            
                                            <text x="30" y="20" text-anchor="middle" font-size="12" fill="white" font-weight="bold">社員ID</text>
                                            <text x="90" y="20" text-anchor="middle" font-size="12" fill="white" font-weight="bold">氏名</text>
                                            <text x="150" y="20" text-anchor="middle" font-size="12" fill="white" font-weight="bold">部署</text>
                                            <text x="210" y="20" text-anchor="middle" font-size="12" fill="white" font-weight="bold">給与</text>
                                            
                                            <!-- Records -->
                                            <g id="record1" class="data-record">
                                                <rect x="0" y="30" width="240" height="30" fill="white" stroke="#ddd"/>
                                                <line x1="60" y1="30" x2="60" y2="60" stroke="#ddd"/>
                                                <line x1="120" y1="30" x2="120" y2="60" stroke="#ddd"/>
                                                <line x1="180" y1="30" x2="180" y2="60" stroke="#ddd"/>
                                                
                                                <rect id="cell-e001" x="0" y="30" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="30" y="50" text-anchor="middle" font-size="11">E001</text>
                                                
                                                <rect id="cell-yamada" x="60" y="30" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="90" y="50" text-anchor="middle" font-size="11">山田太郎</text>
                                                
                                                <rect id="cell-eigyo1" x="120" y="30" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="150" y="50" text-anchor="middle" font-size="11">営業部</text>
                                                
                                                <rect id="cell-300k" x="180" y="30" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="210" y="50" text-anchor="middle" font-size="11">300,000</text>
                                            </g>
                                            
                                            <g id="record2" class="data-record">
                                                <rect x="0" y="60" width="240" height="30" fill="white" stroke="#ddd"/>
                                                <line x1="60" y1="60" x2="60" y2="90" stroke="#ddd"/>
                                                <line x1="120" y1="60" x2="120" y2="90" stroke="#ddd"/>
                                                <line x1="180" y1="60" x2="180" y2="90" stroke="#ddd"/>
                                                
                                                <rect id="cell-e002" x="0" y="60" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="30" y="80" text-anchor="middle" font-size="11">E002</text>
                                                
                                                <rect id="cell-sato" x="60" y="60" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="90" y="80" text-anchor="middle" font-size="11">佐藤花子</text>
                                                
                                                <rect id="cell-dev" x="120" y="60" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="150" y="80" text-anchor="middle" font-size="11">開発部</text>
                                                
                                                <rect id="cell-350k" x="180" y="60" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="210" y="80" text-anchor="middle" font-size="11">350,000</text>
                                            </g>
                                            
                                            <g id="record3" class="data-record">
                                                <rect x="0" y="90" width="240" height="30" fill="white" stroke="#ddd"/>
                                                <line x1="60" y1="90" x2="60" y2="120" stroke="#ddd"/>
                                                <line x1="120" y1="90" x2="120" y2="120" stroke="#ddd"/>
                                                <line x1="180" y1="90" x2="180" y2="120" stroke="#ddd"/>
                                                
                                                <rect id="cell-e003" x="0" y="90" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="30" y="110" text-anchor="middle" font-size="11">E003</text>
                                                
                                                <rect id="cell-suzuki" x="60" y="90" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="90" y="110" text-anchor="middle" font-size="11">鈴木次郎</text>
                                                
                                                <rect id="cell-hr" x="120" y="90" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="150" y="110" text-anchor="middle" font-size="11">人事部</text>
                                                
                                                <rect id="cell-280k" x="180" y="90" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="210" y="110" text-anchor="middle" font-size="11">280,000</text>
                                            </g>
                                            
                                            <g id="record4" class="data-record">
                                                <rect x="0" y="120" width="240" height="30" fill="white" stroke="#ddd"/>
                                                <line x1="60" y1="120" x2="60" y2="150" stroke="#ddd"/>
                                                <line x1="120" y1="120" x2="120" y2="150" stroke="#ddd"/>
                                                <line x1="180" y1="120" x2="180" y2="150" stroke="#ddd"/>
                                                
                                                <rect id="cell-e004" x="0" y="120" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="30" y="140" text-anchor="middle" font-size="11">E004</text>
                                                
                                                <rect id="cell-tanaka" x="60" y="120" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="90" y="140" text-anchor="middle" font-size="11">田中美咲</text>
                                                
                                                <rect id="cell-eigyo2" x="120" y="120" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="150" y="140" text-anchor="middle" font-size="11">営業部</text>
                                                
                                                <rect id="cell-260k" x="180" y="120" width="60" height="30" fill="transparent" class="data-cell"/>
                                                <text x="210" y="140" text-anchor="middle" font-size="11">260,000</text>
                                            </g>
                                        </g>
                                        
                                        <!-- 凡例 -->
                                        <g transform="translate(150, 380)">
                                            <text x="0" y="0" font-size="12" fill="#666">構成要素：</text>
                                            <rect x="0" y="10" width="50" height="20" fill="#4D8BC9" opacity="0.3"/>
                                            <text x="55" y="25" font-size="11" fill="#666">Column（列）</text>
                                            
                                            <rect x="0" y="35" width="50" height="20" fill="#E0EEF9" stroke="#005BAB" stroke-width="1"/>
                                            <text x="55" y="50" font-size="11" fill="#666">Record（行）</text>
                                            
                                            <rect x="0" y="60" width="50" height="20" fill="#FF961C" opacity="0.3"/>
                                            <text x="55" y="75" font-size="11" fill="#666">Cell（値）</text>
                                        </g>
                                    </g>
                                </g>
                                
                                <!-- 他のDatabase（簡略表示） -->
                                <g transform="translate(480, 120)">
                                    <rect x="0" y="0" width="340" height="180" rx="10" fill="#FFF3E0" stroke="#FF961C" stroke-width="2" opacity="0.5"/>
                                    <text x="20" y="25" font-size="16" font-weight="bold" fill="#FF961C" opacity="0.7">Database: 販売管理DB</text>
                                    
                                    <rect x="30" y="50" width="130" height="100" rx="5" fill="#F5F5F5" stroke="#4D8BC9" opacity="0.5"/>
                                    <text x="45" y="75" font-size="12" fill="#4D8BC9">商品テーブル</text>
                                    
                                    <rect x="180" y="50" width="130" height="100" rx="5" fill="#F5F5F5" stroke="#4D8BC9" opacity="0.5"/>
                                    <text x="195" y="75" font-size="12" fill="#4D8BC9">受注テーブル</text>
                                </g>
                                
                                <g transform="translate(480, 320)">
                                    <rect x="0" y="0" width="340" height="180" rx="10" fill="#FFF3E0" stroke="#FF961C" stroke-width="2" opacity="0.5"/>
                                    <text x="20" y="25" font-size="16" font-weight="bold" fill="#FF961C" opacity="0.7">Database: 在庫管理DB</text>
                                    
                                    <rect x="30" y="50" width="130" height="100" rx="5" fill="#F5F5F5" stroke="#4D8BC9" opacity="0.5"/>
                                    <text x="45" y="75" font-size="12" fill="#4D8BC9">在庫テーブル</text>
                                    
                                    <rect x="180" y="50" width="130" height="100" rx="5" fill="#F5F5F5" stroke="#4D8BC9" opacity="0.5"/>
                                    <text x="195" y="75" font-size="12" fill="#4D8BC9">倉庫テーブル</text>
                                </g>
                            </g>
                        </svg>
                    </div>
                    
                    <button class="animation-btn" onclick="animateHierarchy()">階層構造をアニメーションで確認</button>
                    
                    <h3>段階的に構造を理解しよう</h3>
                    <!-- 段階的学習 -->
                    <div class="step-learning">
                        <div class="learning-step active" id="step1">
                            <span class="step-number">1</span>
                            <strong>Table（テーブル）</strong>：データを入れる大きな箱
                            <p>まず、テーブル全体を見てみましょう。これがデータを格納する基本単位です。</p>
                        </div>
                        
                        <div class="learning-step" id="step2">
                            <span class="step-number">2</span>
                            <strong>Column（カラム）</strong>：データの項目（縦の列）
                            <p>各列は特定の種類のデータ（社員ID、氏名など）を表します。</p>
                        </div>
                        
                        <div class="learning-step" id="step3">
                            <span class="step-number">3</span>
                            <strong>Record（レコード）</strong>：1件分のデータ（横の行）
                            <p>各行は1つの完全なデータセット（1人の社員情報など）を表します。</p>
                        </div>
                        
                        <div class="learning-step" id="step4">
                            <span class="step-number">4</span>
                            <strong>Cell（セル）</strong>：個々のデータ値
                            <p>行と列が交差する場所にある、実際のデータ値です。</p>
                        </div>
                    </div>
                    
                    <div class="diagram-container" style="overflow-x: auto; padding: 20px 0;">
                        <svg class="svg-diagram" width="100%" height="450" viewBox="0 0 750 450" preserveAspectRatio="xMidYMid meet" id="table-structure-svg">
                            <text x="375" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#005BAB">社員テーブルの構造</text>
                            
                            <!-- テーブル全体の枠 -->
                            <g id="table-structure">
                                <!-- Table全体を示す枠 -->
                                <rect id="table-frame" x="75" y="60" width="600" height="280" rx="10" fill="none" stroke="#005BAB" stroke-width="3" stroke-dasharray="10,5"/>
                                <text x="375" y="50" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">Table（社員テーブル）</text>
                                
                                <!-- ヘッダー行 -->
                                <rect x="105" y="80" width="540" height="40" fill="#005BAB" opacity="0.8"/>
                                <text x="155" y="105" text-anchor="middle" font-size="14" font-weight="bold" fill="white">社員ID</text>
                                <text x="275" y="105" text-anchor="middle" font-size="14" font-weight="bold" fill="white">氏名</text>
                                <text x="395" y="105" text-anchor="middle" font-size="14" font-weight="bold" fill="white">部署</text>
                                <text x="515" y="105" text-anchor="middle" font-size="14" font-weight="bold" fill="white">入社日</text>
                                <text x="605" y="105" text-anchor="middle" font-size="14" font-weight="bold" fill="white">給与</text>
                                
                                <!-- Column示す矢印 -->
                                <g id="column-indicator" opacity="0">
                                    <line x1="155" y1="50" x2="155" y2="70" stroke="#FF961C" stroke-width="2" marker-end="url(#arrowhead)"/>
                                    <text x="155" y="45" text-anchor="middle" font-size="14" font-weight="bold" fill="#FF961C">Column（列）</text>
                                    <!-- Column全体をハイライト -->
                                    <rect x="105" y="80" width="100" height="240" fill="#FF961C" opacity="0.2"/>
                                </g>
                                
                                <!-- データ行 -->
                                <g id="data-rows">
                                    <!-- 1行目 -->
                                    <rect id="row1" x="105" y="120" width="540" height="40" fill="#E0EEF9" class="record-row"/>
                                    <text x="155" y="145" text-anchor="middle" font-size="14">E001</text>
                                    <text x="275" y="145" text-anchor="middle" font-size="14">山田太郎</text>
                                    <text x="395" y="145" text-anchor="middle" font-size="14">営業部</text>
                                    <text x="515" y="145" text-anchor="middle" font-size="14">2020/04/01</text>
                                    <text x="605" y="145" text-anchor="middle" font-size="14">300,000</text>
                                    
                                    <!-- 2行目（ハイライト） -->
                                    <rect id="row2" x="105" y="160" width="540" height="40" fill="#E0EEF9" stroke="none" stroke-width="2" class="record-row"/>
                                    <text x="155" y="185" text-anchor="middle" font-size="14">E002</text>
                                    <text x="275" y="185" text-anchor="middle" font-size="14">佐藤花子</text>
                                    <text x="395" y="185" text-anchor="middle" font-size="14">開発部</text>
                                    <text x="515" y="185" text-anchor="middle" font-size="14">2019/10/01</text>
                                    <text x="605" y="185" text-anchor="middle" font-size="14">350,000</text>
                                    
                                    <!-- Record示す矢印 -->
                                    <g id="record-indicator" opacity="0">
                                        <line x1="55" y1="180" x2="95" y2="180" stroke="#FF961C" stroke-width="2" marker-end="url(#arrowhead)"/>
                                        <text x="50" y="175" text-anchor="end" font-size="14" font-weight="bold" fill="#FF961C">Record</text>
                                        <text x="50" y="190" text-anchor="end" font-size="14" font-weight="bold" fill="#FF961C">（行）</text>
                                    </g>
                                    
                                    <!-- 3行目 -->
                                    <rect id="row3" x="105" y="200" width="540" height="40" fill="#E0EEF9" class="record-row"/>
                                    <text x="155" y="225" text-anchor="middle" font-size="14">E003</text>
                                    <text x="275" y="225" text-anchor="middle" font-size="14">鈴木次郎</text>
                                    <text x="395" y="225" text-anchor="middle" font-size="14">人事部</text>
                                    <text x="515" y="225" text-anchor="middle" font-size="14">2021/07/01</text>
                                    <text x="605" y="225" text-anchor="middle" font-size="14">280,000</text>
                                    
                                    <!-- 4行目 -->
                                    <rect id="row4" x="105" y="240" width="540" height="40" fill="#E0EEF9" class="record-row"/>
                                    <text x="155" y="265" text-anchor="middle" font-size="14">E004</text>
                                    <text x="275" y="265" text-anchor="middle" font-size="14">田中美咲</text>
                                    <text x="395" y="265" text-anchor="middle" font-size="14">営業部</text>
                                    <text x="515" y="265" text-anchor="middle" font-size="14">2022/04/01</text>
                                    <text x="605" y="265" text-anchor="middle" font-size="14">260,000</text>
                                </g>
                                
                                <!-- 列の区切り線 -->
                                <line x1="205" y1="80" x2="205" y2="280" stroke="#ddd" stroke-width="1"/>
                                <line x1="325" y1="80" x2="325" y2="280" stroke="#ddd" stroke-width="1"/>
                                <line x1="445" y1="80" x2="445" y2="280" stroke="#ddd" stroke-width="1"/>
                                <line x1="565" y1="80" x2="565" y2="280" stroke="#ddd" stroke-width="1"/>
                                
                                <!-- セルハイライト用 -->
                                <rect id="cell-highlight" x="325" y="160" width="120" height="40" fill="#FF961C" opacity="0" stroke="#FF961C" stroke-width="3"/>
                            </g>
                            
                            <!-- 矢印定義 -->
                            <defs>
                                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#FF961C"/>
                                </marker>
                            </defs>
                            
                            <!-- 説明 -->
                            <text x="375" y="420" text-anchor="middle" font-size="14" fill="#666">※ この社員テーブルには4件のレコード（社員情報）が格納されています</text>
                        </svg>
                    </div>
                    
                    <button class="animation-btn" onclick="animateTableStructure()">構造をアニメーションで確認</button>
                    <button class="animation-btn" onclick="resetAnimation()">リセット</button>
                </div>
            </div>
            
            <!-- SQL基礎 -->
            <div id="sql-basics" class="tab-content">
                <div class="section">
                    <h2>SQL - データベースと対話する言語</h2>
                    
                    <div class="concept-box">
                        <h3>SQL（Structured Query Language）とは？</h3>
                        <p><span class="tooltip">SQL<span class="tooltiptext">Structured Query Language（構造化問い合わせ言語）の略。データベースに対して命令を出すための標準的な言語。ほぼすべてのDBMSで使用可能</span></span>は、データベースに対して「データをこうしてください」と指示を出すための言語です。</p>
                        <p>主な操作は<span class="tooltip">CRUD（クラッド）<span class="tooltiptext">Create（作成）、Read（読取）、Update（更新）、Delete（削除）の頭文字を取った言葉。データベース操作の基本的な4つの機能を表す</span></span>と呼ばれる4つの基本操作です：</p>
                        <ul>
                            <li><strong>C</strong>reate（作成）：<span class="keyword">INSERT</span>文でデータを追加</li>
                            <li><strong>R</strong>ead（読取）：<span class="keyword">SELECT</span>文でデータを検索</li>
                            <li><strong>U</strong>pdate（更新）：<span class="keyword">UPDATE</span>文でデータを変更</li>
                            <li><strong>D</strong>elete（削除）：<span class="keyword">DELETE</span>文でデータを削除</li>
                        </ul>
                    </div>
                    
                    <h3>SQL文の基本構造</h3>
                    <div class="code-highlight">
                        <span class="comment">-- 基本的なSELECT文の構造</span><br>
                        <span class="keyword">SELECT</span> 列名1, 列名2<br>
                        <span class="keyword">FROM</span> テーブル名<br>
                        <span class="keyword">WHERE</span> 条件<br>
                        <span class="keyword">ORDER BY</span> 列名 <span class="keyword">ASC</span>/<span class="keyword">DESC</span>;<br><br>
                        
                        <span class="comment">-- 例：営業部の社員を給与順に表示</span><br>
                        <span class="keyword">SELECT</span> 氏名, 給与<br>
                        <span class="keyword">FROM</span> 社員<br>
                        <span class="keyword">WHERE</span> 部署 = <span class="string">'営業部'</span><br>
                        <span class="keyword">ORDER BY</span> 給与 <span class="keyword">DESC</span>;
                    </div>
                    
                    <h3>データ取得の流れ</h3>
                    <div class="diagram-container">
                        <svg class="svg-diagram" width="900" height="700" viewBox="0 0 900 700" id="select-flow-svg">
                            <text x="450" y="30" text-anchor="middle" font-size="22" font-weight="bold" fill="#005BAB">SELECT文の実行フロー</text>
                            
                            <!-- SQL文表示 -->
                            <rect x="150" y="60" width="600" height="50" rx="8" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                            <text x="450" y="90" text-anchor="middle" font-family="'Courier New', monospace" font-size="16" fill="#333">
                                SELECT 氏名, 給与 FROM 社員 WHERE 部署 = '営業部';
                            </text>
                            
                            <!-- ステップ表示エリア -->
                            <g id="step-indicator" transform="translate(100, 130)">
                                <rect id="step-box" x="0" y="0" width="700" height="40" rx="5" fill="#E0EEF9" stroke="#005BAB" stroke-width="2"/>
                                <text id="step-text" x="350" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="#005BAB">
                                    ステップ 1: テーブル全体を確認
                                </text>
                            </g>
                            
                            <!-- テーブル表示 -->
                            <g transform="translate(200, 200)">
                                <text x="250" y="-10" text-anchor="middle" font-size="18" font-weight="bold" fill="#4D8BC9">社員テーブル</text>
                                
                                <!-- ヘッダー -->
                                <g id="select-header">
                                    <rect x="0" y="0" width="500" height="40" fill="#4D8BC9" opacity="0.8"/>
                                    <line x1="100" y1="0" x2="100" y2="40" stroke="white" stroke-width="1"/>
                                    <line x1="200" y1="0" x2="200" y2="40" stroke="white" stroke-width="1"/>
                                    <line x1="300" y1="0" x2="300" y2="40" stroke="white" stroke-width="1"/>
                                    <line x1="400" y1="0" x2="400" y2="40" stroke="white" stroke-width="1"/>
                                    
                                    <rect id="col-id" x="0" y="0" width="100" height="40" fill="transparent" class="column-highlight"/>
                                    <text x="50" y="25" text-anchor="middle" font-size="14" fill="white" font-weight="bold">社員ID</text>
                                    
                                    <rect id="col-name" x="100" y="0" width="100" height="40" fill="transparent" class="column-highlight"/>
                                    <text x="150" y="25" text-anchor="middle" font-size="14" fill="white" font-weight="bold">氏名</text>
                                    
                                    <rect id="col-dept" x="200" y="0" width="100" height="40" fill="transparent" class="column-highlight"/>
                                    <text x="250" y="25" text-anchor="middle" font-size="14" fill="white" font-weight="bold">部署</text>
                                    
                                    <rect id="col-date" x="300" y="0" width="100" height="40" fill="transparent" class="column-highlight"/>
                                    <text x="350" y="25" text-anchor="middle" font-size="14" fill="white" font-weight="bold">入社日</text>
                                    
                                    <rect id="col-salary" x="400" y="0" width="100" height="40" fill="transparent" class="column-highlight"/>
                                    <text x="450" y="25" text-anchor="middle" font-size="14" fill="white" font-weight="bold">給与</text>
                                </g>
                                
                                <!-- データ行 -->
                                <g id="select-row1" class="select-record">
                                    <rect x="0" y="40" width="500" height="40" fill="white" stroke="#ddd" stroke-width="1"/>
                                    <line x1="100" y1="40" x2="100" y2="80" stroke="#ddd"/>
                                    <line x1="200" y1="40" x2="200" y2="80" stroke="#ddd"/>
                                    <line x1="300" y1="40" x2="300" y2="80" stroke="#ddd"/>
                                    <line x1="400" y1="40" x2="400" y2="80" stroke="#ddd"/>
                                    
                                    <text x="50" y="65" text-anchor="middle" font-size="12">E001</text>
                                    <text x="150" y="65" text-anchor="middle" font-size="12">山田太郎</text>
                                    <text x="250" y="65" text-anchor="middle" font-size="12">営業部</text>
                                    <text x="350" y="65" text-anchor="middle" font-size="12">2020/04/01</text>
                                    <text x="450" y="65" text-anchor="middle" font-size="12">300,000</text>
                                </g>
                                
                                <g id="select-row2" class="select-record">
                                    <rect x="0" y="80" width="500" height="40" fill="white" stroke="#ddd" stroke-width="1"/>
                                    <line x1="100" y1="80" x2="100" y2="120" stroke="#ddd"/>
                                    <line x1="200" y1="80" x2="200" y2="120" stroke="#ddd"/>
                                    <line x1="300" y1="80" x2="300" y2="120" stroke="#ddd"/>
                                    <line x1="400" y1="80" x2="400" y2="120" stroke="#ddd"/>
                                    
                                    <text x="50" y="105" text-anchor="middle" font-size="12">E002</text>
                                    <text x="150" y="105" text-anchor="middle" font-size="12">佐藤花子</text>
                                    <text x="250" y="105" text-anchor="middle" font-size="12">開発部</text>
                                    <text x="350" y="105" text-anchor="middle" font-size="12">2019/10/01</text>
                                    <text x="450" y="105" text-anchor="middle" font-size="12">350,000</text>
                                </g>
                                
                                <g id="select-row3" class="select-record">
                                    <rect x="0" y="120" width="500" height="40" fill="white" stroke="#ddd" stroke-width="1"/>
                                    <line x1="100" y1="120" x2="100" y2="160" stroke="#ddd"/>
                                    <line x1="200" y1="120" x2="200" y2="160" stroke="#ddd"/>
                                    <line x1="300" y1="120" x2="300" y2="160" stroke="#ddd"/>
                                    <line x1="400" y1="120" x2="400" y2="160" stroke="#ddd"/>
                                    
                                    <text x="50" y="145" text-anchor="middle" font-size="12">E003</text>
                                    <text x="150" y="145" text-anchor="middle" font-size="12">鈴木次郎</text>
                                    <text x="250" y="145" text-anchor="middle" font-size="12">人事部</text>
                                    <text x="350" y="145" text-anchor="middle" font-size="12">2021/07/01</text>
                                    <text x="450" y="145" text-anchor="middle" font-size="12">280,000</text>
                                </g>
                                
                                <g id="select-row4" class="select-record">
                                    <rect x="0" y="160" width="500" height="40" fill="white" stroke="#ddd" stroke-width="1"/>
                                    <line x1="100" y1="160" x2="100" y2="200" stroke="#ddd"/>
                                    <line x1="200" y1="160" x2="200" y2="200" stroke="#ddd"/>
                                    <line x1="300" y1="160" x2="300" y2="200" stroke="#ddd"/>
                                    <line x1="400" y1="160" x2="400" y2="200" stroke="#ddd"/>
                                    
                                    <text x="50" y="185" text-anchor="middle" font-size="12">E004</text>
                                    <text x="150" y="185" text-anchor="middle" font-size="12">田中美咲</text>
                                    <text x="250" y="185" text-anchor="middle" font-size="12">営業部</text>
                                    <text x="350" y="185" text-anchor="middle" font-size="12">2022/04/01</text>
                                    <text x="450" y="185" text-anchor="middle" font-size="12">260,000</text>
                                </g>
                            </g>
                            
                            <!-- 結果表示エリア -->
                            <g id="result-area" transform="translate(300, 450)" opacity="0">
                                <text x="150" y="0" text-anchor="middle" font-size="18" font-weight="bold" fill="#FF961C">実行結果</text>
                                
                                <rect x="0" y="10" width="300" height="40" fill="#FF961C" opacity="0.8"/>
                                <line x1="150" y1="10" x2="150" y2="50" stroke="white" stroke-width="1"/>
                                
                                <text x="75" y="35" text-anchor="middle" font-size="14" fill="white" font-weight="bold">氏名</text>
                                <text x="225" y="35" text-anchor="middle" font-size="14" fill="white" font-weight="bold">給与</text>
                                
                                <g id="result-row1">
                                    <rect x="0" y="50" width="300" height="40" fill="#FFF3E0" stroke="#FF961C" stroke-width="1"/>
                                    <line x1="150" y1="50" x2="150" y2="90" stroke="#FF961C"/>
                                    
                                    <text x="75" y="75" text-anchor="middle" font-size="12">山田太郎</text>
                                    <text x="225" y="75" text-anchor="middle" font-size="12">300,000</text>
                                </g>
                                
                                <g id="result-row2">
                                    <rect x="0" y="90" width="300" height="40" fill="#FFF3E0" stroke="#FF961C" stroke-width="1"/>
                                    <line x1="150" y1="90" x2="150" y2="130" stroke="#FF961C"/>
                                    
                                    <text x="75" y="115" text-anchor="middle" font-size="12">田中美咲</text>
                                    <text x="225" y="115" text-anchor="middle" font-size="12">260,000</text>
                                </g>
                            </g>
                            
                            <!-- WHERE句の条件表示 -->
                            <g id="where-condition" transform="translate(50, 300)" opacity="0">
                                <rect x="0" y="0" width="120" height="60" rx="5" fill="#FFEBEE" stroke="#F44336" stroke-width="2"/>
                                <text x="60" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="#F44336">WHERE条件</text>
                                <text x="60" y="45" text-anchor="middle" font-size="11" fill="#333">部署 = '営業部'</text>
                            </g>
                            
                            <!-- SELECT句の表示 -->
                            <g id="select-columns" transform="translate(730, 300)" opacity="0">
                                <rect x="0" y="0" width="120" height="60" rx="5" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                                <text x="60" y="25" text-anchor="middle" font-size="12" font-weight="bold" fill="#4CAF50">SELECT句</text>
                                <text x="60" y="45" text-anchor="middle" font-size="11" fill="#333">氏名, 給与</text>
                            </g>
                            
                            <!-- 矢印定義 -->
                            <defs>
                                <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                    
                    <button class="animation-btn" onclick="animateSelectFlow()">SELECT文の実行をアニメーションで確認</button>
                    <button class="animation-btn" onclick="resetSelectAnimation()">リセット</button>
                </div>
            </div>
            
            <!-- CRUD操作 -->
            <div id="crud" class="tab-content">
                <div class="section">
                    <h2>CRUD操作を実践してみよう</h2>
                    
                    <!-- SELECT -->
                    <div class="concept-box">
                        <h3>1. SELECT（データの検索）</h3>
                        <p>データベースからデータを取り出す最も基本的な操作です。</p>
                        
                        <div class="code-highlight">
                            <span class="comment">-- 全社員の情報を取得</span><br>
                            <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> 社員;<br><br>
                            
                            <span class="comment">-- 特定の列だけを取得</span><br>
                            <span class="keyword">SELECT</span> 氏名, 部署 <span class="keyword">FROM</span> 社員;<br><br>
                            
                            <span class="comment">-- 条件を指定して取得</span><br>
                            <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> 社員 <span class="keyword">WHERE</span> 部署 = <span class="string">'営業部'</span>;
                        </div>
                        
                        <div class="example-card" onclick="loadExample('select1')">
                            <strong>例題1:</strong> 全社員の氏名と部署を表示してみよう
                        </div>
                        
                        <div class="example-card" onclick="loadExample('select2')">
                            <strong>例題2:</strong> 給与が30万円以上の社員を検索してみよう
                        </div>
                    </div>
                    
                    <!-- INSERT -->
                    <div class="concept-box">
                        <h3>2. INSERT（データの追加）</h3>
                        <p>テーブルに新しいレコード（行）を追加します。</p>
                        
                        <div class="code-highlight">
                            <span class="comment">-- 新しい社員を追加</span><br>
                            <span class="keyword">INSERT INTO</span> 社員 (社員ID, 氏名, 部署, 入社日, 給与)<br>
                            <span class="keyword">VALUES</span> (<span class="string">'E005'</span>, <span class="string">'高橋健一'</span>, <span class="string">'開発部'</span>, <span class="string">'2023/04/01'</span>, 290000);
                        </div>
                        
                        <div class="example-card" onclick="loadExample('insert1')">
                            <strong>例題3:</strong> 新入社員「伊藤さん」を人事部に追加してみよう
                        </div>
                    </div>
                    
                    <!-- UPDATE -->
                    <div class="concept-box">
                        <h3>3. UPDATE（データの更新）</h3>
                        <p>既存のデータを変更します。<span class="tooltip">WHERE句<span class="tooltiptext">更新対象を限定する条件。これを忘れると全レコードが更新されてしまうので要注意！必ず条件を指定すること</span></span>を忘れずに！</p>
                        
                        <div class="code-highlight">
                            <span class="comment">-- 特定社員の部署を変更</span><br>
                            <span class="keyword">UPDATE</span> 社員<br>
                            <span class="keyword">SET</span> 部署 = <span class="string">'企画部'</span><br>
                            <span class="keyword">WHERE</span> 社員ID = <span class="string">'E003'</span>;<br><br>
                            
                            <span class="comment">-- 営業部全員の給与を5%アップ</span><br>
                            <span class="keyword">UPDATE</span> 社員<br>
                            <span class="keyword">SET</span> 給与 = 給与 * 1.05<br>
                            <span class="keyword">WHERE</span> 部署 = <span class="string">'営業部'</span>;
                        </div>
                        
                        <div class="example-card" onclick="loadExample('update1')">
                            <strong>例題4:</strong> 山田太郎さんを営業部から企画部に異動させよう
                        </div>
                    </div>
                    
                    <!-- DELETE -->
                    <div class="concept-box">
                        <h3>4. DELETE（データの削除）</h3>
                        <p>レコードを削除します。<strong style="color: var(--danger-color);">削除は取り消せないので慎重に！</strong></p>
                        
                        <div class="code-highlight">
                            <span class="comment">-- 特定の社員を削除</span><br>
                            <span class="keyword">DELETE FROM</span> 社員<br>
                            <span class="keyword">WHERE</span> 社員ID = <span class="string">'E004'</span>;<br><br>
                            
                            <span class="comment">-- 退職日が設定されている社員を削除</span><br>
                            <span class="keyword">DELETE FROM</span> 社員<br>
                            <span class="keyword">WHERE</span> 退職日 <span class="keyword">IS NOT NULL</span>;
                        </div>
                        
                        <div class="example-card" onclick="loadExample('delete1')">
                            <strong>例題5:</strong> 社員ID 'E999'（テストデータ）を削除してみよう
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- WHERE句 -->
            <div id="where" class="tab-content">
                <div class="section">
                    <h2>WHERE句 - 条件を指定する</h2>
                    
                    <div class="concept-box">
                        <h3>WHERE句と条件演算子</h3>
                        <p>WHERE句を使うと、特定の条件に合うデータだけを対象にできます。</p>
                    </div>
                    
                    <div class="diagram-container">
                        <svg class="svg-diagram" width="800" height="500" viewBox="0 0 800 500">
                            <text x="400" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#005BAB">WHERE句の条件演算子</text>
                            
                            <!-- AND演算子 -->
                            <g transform="translate(100, 60)">
                                <text x="100" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">AND（かつ）</text>
                                <!-- ベン図 -->
                                <circle cx="70" cy="70" r="40" fill="#E0EEF9" stroke="#005BAB" stroke-width="2" opacity="0.7"/>
                                <circle cx="130" cy="70" r="40" fill="#E0EEF9" stroke="#005BAB" stroke-width="2" opacity="0.7"/>
                                <!-- 重なり部分を強調 -->
                                <path d="M 100,40 A 40,40 0 0,1 100,100 A 40,40 0 0,1 100,40" fill="#FF961C" opacity="0.8"/>
                                
                                <text x="50" y="120" font-size="12" fill="#333">条件A</text>
                                <text x="130" y="120" font-size="12" fill="#333">条件B</text>
                                <text x="100" y="140" text-anchor="middle" font-size="11" fill="#666">両方満たす</text>
                                
                                <!-- 例 -->
                                <rect x="20" y="160" width="160" height="60" fill="#f5f5f5" stroke="#ddd" rx="5"/>
                                <text x="100" y="180" text-anchor="middle" font-size="12" fill="#333">例：部署 = '営業部'</text>
                                <text x="100" y="195" text-anchor="middle" font-size="12" font-weight="bold" fill="#005BAB">AND</text>
                                <text x="100" y="210" text-anchor="middle" font-size="12" fill="#333">給与 >= 300000</text>
                            </g>
                            
                            <!-- OR演算子 -->
                            <g transform="translate(300, 60)">
                                <text x="100" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">OR（または）</text>
                                <!-- ベン図 -->
                                <circle cx="70" cy="70" r="40" fill="#FF961C" stroke="#005BAB" stroke-width="2" opacity="0.7"/>
                                <circle cx="130" cy="70" r="40" fill="#FF961C" stroke="#005BAB" stroke-width="2" opacity="0.7"/>
                                
                                <text x="50" y="120" font-size="12" fill="#333">条件A</text>
                                <text x="130" y="120" font-size="12" fill="#333">条件B</text>
                                <text x="100" y="140" text-anchor="middle" font-size="11" fill="#666">どちらか満たす</text>
                                
                                <!-- 例 -->
                                <rect x="20" y="160" width="160" height="60" fill="#f5f5f5" stroke="#ddd" rx="5"/>
                                <text x="100" y="180" text-anchor="middle" font-size="12" fill="#333">例：部署 = '営業部'</text>
                                <text x="100" y="195" text-anchor="middle" font-size="12" font-weight="bold" fill="#005BAB">OR</text>
                                <text x="100" y="210" text-anchor="middle" font-size="12" fill="#333">部署 = '開発部'</text>
                            </g>
                            
                            <!-- NOT演算子 -->
                            <g transform="translate(500, 60)">
                                <text x="100" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">NOT（ではない）</text>
                                <!-- 円 -->
                                <rect x="50" y="40" width="100" height="80" fill="#f5f5f5" stroke="#ddd" stroke-width="2" rx="5"/>
                                <circle cx="100" cy="80" r="30" fill="white" stroke="#FF961C" stroke-width="3"/>
                                <line x1="80" y1="60" x2="120" y2="100" stroke="#FF961C" stroke-width="3"/>
                                <line x1="120" y1="60" x2="80" y2="100" stroke="#FF961C" stroke-width="3"/>
                                
                                <text x="100" y="140" text-anchor="middle" font-size="11" fill="#666">条件を満たさない</text>
                                
                                <!-- 例 -->
                                <rect x="20" y="160" width="160" height="60" fill="#f5f5f5" stroke="#ddd" rx="5"/>
                                <text x="100" y="180" text-anchor="middle" font-size="12" fill="#333">例：</text>
                                <text x="100" y="195" text-anchor="middle" font-size="12" font-weight="bold" fill="#005BAB">NOT</text>
                                <text x="100" y="210" text-anchor="middle" font-size="12" fill="#333">部署 = '人事部'</text>
                            </g>
                            
                            <!-- IN演算子 -->
                            <g transform="translate(200, 280)">
                                <text x="100" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">IN（いずれかに含まれる）</text>
                                
                                <!-- リスト表現 -->
                                <rect x="40" y="40" width="120" height="100" fill="#E0EEF9" stroke="#005BAB" stroke-width="2" rx="5"/>
                                <text x="100" y="60" text-anchor="middle" font-size="12" fill="#333">値のリスト</text>
                                <text x="100" y="80" text-anchor="middle" font-size="11" fill="#666">・営業部</text>
                                <text x="100" y="95" text-anchor="middle" font-size="11" fill="#666">・開発部</text>
                                <text x="100" y="110" text-anchor="middle" font-size="11" fill="#666">・企画部</text>
                                <text x="100" y="130" text-anchor="middle" font-size="11" fill="#FF961C">✓ どれかに一致</text>
                                
                                <!-- 例 -->
                                <rect x="20" y="160" width="160" height="60" fill="#f5f5f5" stroke="#ddd" rx="5"/>
                                <text x="100" y="180" text-anchor="middle" font-size="12" fill="#333">例：部署</text>
                                <text x="100" y="195" text-anchor="middle" font-size="12" font-weight="bold" fill="#005BAB">IN</text>
                                <text x="100" y="210" text-anchor="middle" font-size="11" fill="#333">('営業部', '開発部', '企画部')</text>
                            </g>
                            
                            <!-- 比較演算子 -->
                            <g transform="translate(450, 280)">
                                <text x="100" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">比較演算子</text>
                                
                                <rect x="20" y="40" width="160" height="140" fill="#f5f5f5" stroke="#ddd" rx="5"/>
                                <text x="30" y="60" font-size="12" fill="#333"><tspan font-weight="bold">=</tspan> : 等しい</text>
                                <text x="30" y="80" font-size="12" fill="#333"><tspan font-weight="bold">!=</tspan> : 等しくない</text>
                                <text x="30" y="100" font-size="12" fill="#333"><tspan font-weight="bold">&lt;</tspan> : より小さい</text>
                                <text x="30" y="120" font-size="12" fill="#333"><tspan font-weight="bold">&gt;</tspan> : より大きい</text>
                                <text x="30" y="140" font-size="12" fill="#333"><tspan font-weight="bold">&lt;=</tspan> : 以下</text>
                                <text x="30" y="160" font-size="12" fill="#333"><tspan font-weight="bold">&gt;=</tspan> : 以上</text>
                            </g>
                        </svg>
                    </div>
                    
                    <div class="example-card" onclick="loadExample('where1')">
                        <strong>例題6:</strong> 営業部で給与が30万円以上の社員を検索（AND）
                    </div>
                    
                    <div class="example-card" onclick="loadExample('where2')">
                        <strong>例題7:</strong> 営業部または開発部の社員を検索（OR）
                    </div>
                    
                    <div class="example-card" onclick="loadExample('where3')">
                        <strong>例題8:</strong> 営業部、開発部、企画部のいずれかの社員を検索（IN）
                    </div>
                </div>
            </div>
            
            <!-- JOIN -->
            <div id="join" class="tab-content">
                <div class="section">
                    <h2>JOIN - 複数テーブルを結合する</h2>
                    
                    <div class="concept-box">
                        <h3>JOINとは？</h3>
                        <p>複数のテーブルを関連付けて、まとめて情報を取得する機能です。</p>
                        <p>例：社員テーブルと部署テーブルを結合して、部署の詳細情報も一緒に取得</p>
                    </div>
                    
                    <div class="diagram-container">
                        <svg class="svg-diagram" width="900" height="500" viewBox="0 0 900 500">
                            <text x="450" y="30" text-anchor="middle" font-size="20" font-weight="bold" fill="#005BAB">JOINの仕組み</text>
                            
                            <!-- 社員テーブル -->
                            <g transform="translate(50, 60)">
                                <text x="150" y="0" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">社員テーブル</text>
                                <rect x="0" y="10" width="300" height="160" fill="#E0EEF9" stroke="#005BAB" stroke-width="2"/>
                                
                                <!-- ヘッダー -->
                                <rect x="0" y="10" width="300" height="30" fill="#005BAB"/>
                                <text x="50" y="30" text-anchor="middle" font-size="12" fill="white">社員ID</text>
                                <text x="150" y="30" text-anchor="middle" font-size="12" fill="white">氏名</text>
                                <text x="250" y="30" text-anchor="middle" font-size="12" fill="white">部署コード</text>
                                
                                <!-- データ -->
                                <line x1="0" y1="40" x2="300" y2="40" stroke="#ddd"/>
                                <text x="50" y="60" text-anchor="middle" font-size="12">E001</text>
                                <text x="150" y="60" text-anchor="middle" font-size="12">山田太郎</text>
                                <text x="250" y="60" text-anchor="middle" font-size="12" fill="#FF961C" font-weight="bold">D01</text>
                                
                                <line x1="0" y1="70" x2="300" y2="70" stroke="#ddd"/>
                                <text x="50" y="90" text-anchor="middle" font-size="12">E002</text>
                                <text x="150" y="90" text-anchor="middle" font-size="12">佐藤花子</text>
                                <text x="250" y="90" text-anchor="middle" font-size="12" fill="#FF961C" font-weight="bold">D02</text>
                                
                                <line x1="0" y1="100" x2="300" y2="100" stroke="#ddd"/>
                                <text x="50" y="120" text-anchor="middle" font-size="12">E003</text>
                                <text x="150" y="120" text-anchor="middle" font-size="12">鈴木次郎</text>
                                <text x="250" y="120" text-anchor="middle" font-size="12" fill="#FF961C" font-weight="bold">D03</text>
                                
                                <!-- 縦線 -->
                                <line x1="100" y1="10" x2="100" y2="170" stroke="#ddd"/>
                                <line x1="200" y1="10" x2="200" y2="170" stroke="#ddd"/>
                            </g>
                            
                            <!-- 部署テーブル -->
                            <g transform="translate(450, 60)">
                                <text x="150" y="0" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">部署テーブル</text>
                                <rect x="0" y="10" width="300" height="130" fill="#E0EEF9" stroke="#005BAB" stroke-width="2"/>
                                
                                <!-- ヘッダー -->
                                <rect x="0" y="10" width="300" height="30" fill="#005BAB"/>
                                <text x="50" y="30" text-anchor="middle" font-size="12" fill="white">部署コード</text>
                                <text x="150" y="30" text-anchor="middle" font-size="12" fill="white">部署名</text>
                                <text x="250" y="30" text-anchor="middle" font-size="12" fill="white">場所</text>
                                
                                <!-- データ -->
                                <line x1="0" y1="40" x2="300" y2="40" stroke="#ddd"/>
                                <text x="50" y="60" text-anchor="middle" font-size="12" fill="#FF961C" font-weight="bold">D01</text>
                                <text x="150" y="60" text-anchor="middle" font-size="12">営業部</text>
                                <text x="250" y="60" text-anchor="middle" font-size="12">東京</text>
                                
                                <line x1="0" y1="70" x2="300" y2="70" stroke="#ddd"/>
                                <text x="50" y="90" text-anchor="middle" font-size="12" fill="#FF961C" font-weight="bold">D02</text>
                                <text x="150" y="90" text-anchor="middle" font-size="12">開発部</text>
                                <text x="250" y="90" text-anchor="middle" font-size="12">大阪</text>
                                
                                <line x1="0" y1="100" x2="300" y2="100" stroke="#ddd"/>
                                <text x="50" y="120" text-anchor="middle" font-size="12" fill="#FF961C" font-weight="bold">D03</text>
                                <text x="150" y="120" text-anchor="middle" font-size="12">人事部</text>
                                <text x="250" y="120" text-anchor="middle" font-size="12">東京</text>
                                
                                <!-- 縦線 -->
                                <line x1="100" y1="10" x2="100" y2="140" stroke="#ddd"/>
                                <line x1="200" y1="10" x2="200" y2="140" stroke="#ddd"/>
                            </g>
                            
                            <!-- 結合線 -->
                            <path d="M 350,70 Q 400,70 450,70" fill="none" stroke="#FF961C" stroke-width="2" marker-end="url(#arrowhead3)"/>
                            <path d="M 350,100 Q 400,100 450,100" fill="none" stroke="#FF961C" stroke-width="2" marker-end="url(#arrowhead3)"/>
                            <path d="M 350,130 Q 400,130 450,130" fill="none" stroke="#FF961C" stroke-width="2" marker-end="url(#arrowhead3)"/>
                            
                            <text x="400" y="60" text-anchor="middle" font-size="14" font-weight="bold" fill="#FF961C">JOIN</text>
                            
                            <!-- 結果テーブル -->
                            <g transform="translate(100, 280)">
                                <text x="300" y="0" text-anchor="middle" font-size="16" font-weight="bold" fill="#005BAB">JOIN結果</text>
                                <rect x="0" y="10" width="600" height="130" fill="#FFF3E0" stroke="#FF961C" stroke-width="2"/>
                                
                                <!-- ヘッダー -->
                                <rect x="0" y="10" width="600" height="30" fill="#FF961C"/>
                                <text x="50" y="30" text-anchor="middle" font-size="12" fill="white">社員ID</text>
                                <text x="150" y="30" text-anchor="middle" font-size="12" fill="white">氏名</text>
                                <text x="250" y="30" text-anchor="middle" font-size="12" fill="white">部署コード</text>
                                <text x="350" y="30" text-anchor="middle" font-size="12" fill="white">部署名</text>
                                <text x="500" y="30" text-anchor="middle" font-size="12" fill="white">場所</text>
                                
                                <!-- データ -->
                                <line x1="0" y1="40" x2="600" y2="40" stroke="#ddd"/>
                                <text x="50" y="60" text-anchor="middle" font-size="12">E001</text>
                                <text x="150" y="60" text-anchor="middle" font-size="12">山田太郎</text>
                                <text x="250" y="60" text-anchor="middle" font-size="12">D01</text>
                                <text x="350" y="60" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF961C">営業部</text>
                                <text x="500" y="60" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF961C">東京</text>
                                
                                <line x1="0" y1="70" x2="600" y2="70" stroke="#ddd"/>
                                <text x="50" y="90" text-anchor="middle" font-size="12">E002</text>
                                <text x="150" y="90" text-anchor="middle" font-size="12">佐藤花子</text>
                                <text x="250" y="90" text-anchor="middle" font-size="12">D02</text>
                                <text x="350" y="90" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF961C">開発部</text>
                                <text x="500" y="90" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF961C">大阪</text>
                                
                                <line x1="0" y1="100" x2="600" y2="100" stroke="#ddd"/>
                                <text x="50" y="120" text-anchor="middle" font-size="12">E003</text>
                                <text x="150" y="120" text-anchor="middle" font-size="12">鈴木次郎</text>
                                <text x="250" y="120" text-anchor="middle" font-size="12">D03</text>
                                <text x="350" y="120" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF961C">人事部</text>
                                <text x="500" y="120" text-anchor="middle" font-size="12" font-weight="bold" fill="#FF961C">東京</text>
                                
                                <!-- 縦線 -->
                                <line x1="100" y1="10" x2="100" y2="140" stroke="#ddd"/>
                                <line x1="200" y1="10" x2="200" y2="140" stroke="#ddd"/>
                                <line x1="300" y1="10" x2="300" y2="140" stroke="#ddd"/>
                                <line x1="400" y1="10" x2="400" y2="140" stroke="#ddd"/>
                            </g>
                            
                            <!-- 矢印定義 -->
                            <defs>
                                <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#FF961C"/>
                                </marker>
                            </defs>
                            
                            <!-- SQL文 -->
                            <text x="450" y="460" text-anchor="middle" font-size="14" fill="#333">
                                SELECT * FROM 社員 JOIN 部署 ON 社員.部署コード = 部署.部署コード;
                            </text>
                        </svg>
                    </div>
                    
                    <div class="example-card" onclick="loadExample('join1')">
                        <strong>例題9:</strong> 社員情報と部署情報を結合して表示してみよう
                    </div>
                </div>
            </div>
            
            <!-- トランザクション -->
            <div id="transaction" class="tab-content">
                <div class="section">
                    <h2>トランザクション - 安全な処理の単位</h2>
                    
                    <div class="concept-box">
                        <h3>トランザクションとは？</h3>
                        <p><span class="tooltip">トランザクション<span class="tooltiptext">複数の処理を1つのまとまりとして扱う仕組み。途中で失敗した場合は、すべての処理を取り消して元の状態に戻す（ロールバック）ことができる</span></span>は、「すべて成功」か「すべて失敗」のどちらかになる処理のまとまりです。</p>
                        <p>銀行のATMでお金を振り込む場合を考えてみましょう：</p>
                    </div>
                    
                    <div class="transaction-demo">
                        <h3>🏦 銀行振込のトランザクション例</h3>
                        
                        <div class="transaction-step" id="trans-step1">
                            <strong>ステップ1:</strong> トランザクション開始
                            <p>BEGIN TRANSACTION;</p>
                        </div>
                        
                        <div class="transaction-step" id="trans-step2">
                            <strong>ステップ2:</strong> A さんの口座から10万円を引く
                            <p>UPDATE 口座 SET 残高 = 残高 - 100000 WHERE 口座番号 = 'A001';</p>
                        </div>
                        
                        <div class="transaction-step" id="trans-step3">
                            <strong>ステップ3:</strong> B さんの口座に10万円を足す
                            <p>UPDATE 口座 SET 残高 = 残高 + 100000 WHERE 口座番号 = 'B002';</p>
                        </div>
                        
                        <div class="transaction-step" id="trans-step4">
                            <strong>ステップ4:</strong> すべて成功したら確定（コミット）
                            <p>COMMIT;</p>
                        </div>
                        
                        <button class="animation-btn" onclick="animateTransaction('success')">成功パターンを見る</button>
                        <button class="animation-btn" style="background: var(--danger-color);" onclick="animateTransaction('error')">失敗パターンを見る</button>
                        
                        <div class="concept-box" style="margin-top: 2rem;">
                            <h4>なぜトランザクションが必要？</h4>
                            <ul>
                                <li>💰 <strong>原子性</strong>：途中で処理が止まっても、お金が消えたり増えたりしない</li>
                                <li>🔒 <strong>一貫性</strong>：データの整合性が保たれる</li>
                                <li>👥 <strong>独立性</strong>：他の処理と干渉しない</li>
                                <li>💾 <strong>永続性</strong>：コミット後はデータが確実に保存される</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- データ型 -->
            <div id="data-types" class="tab-content">
                <div class="section">
                    <h2>データ型 - データの種類を指定する</h2>
                    
                    <div class="concept-box">
                        <h3>主要なデータ型</h3>
                        <p>データベースでは、各カラムにどんな種類のデータを入れるか指定する必要があります。</p>
                    </div>
                    
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>データ型</th>
                                <th>説明</th>
                                <th>使用例</th>
                                <th>サンプル値</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>INT / INTEGER</strong></td>
                                <td>整数（小数点なし）<br><small style="color: #666;">-2,147,483,648～2,147,483,647の範囲</small></td>
                                <td>年齢、個数、ID番号</td>
                                <td>25, 1000, -50</td>
                            </tr>
                            <tr>
                                <td><strong>DECIMAL(10,2)</strong></td>
                                <td>小数（精度指定可能）<br><small style="color: #666;">全体10桁、小数点以下2桁</small></td>
                                <td>金額、重量、率</td>
                                <td>1234.56, 0.95</td>
                            </tr>
                            <tr>
                                <td><strong>VARCHAR(50)</strong></td>
                                <td>可変長文字列<br><small style="color: #666;">最大50文字まで格納可能</small></td>
                                <td>氏名、住所、商品名</td>
                                <td>'山田太郎', '東京都'</td>
                            </tr>
                            <tr>
                                <td><strong>TEXT</strong></td>
                                <td>長い文字列<br><small style="color: #666;">VARCHARより大きなテキスト用</small></td>
                                <td>コメント、説明文</td>
                                <td>'これは長い説明文...'</td>
                            </tr>
                            <tr>
                                <td><strong>DATE</strong></td>
                                <td>日付<br><small style="color: #666;">年月日のみ（時刻なし）</small></td>
                                <td>誕生日、入社日</td>
                                <td>'2024-01-15'</td>
                            </tr>
                            <tr>
                                <td><strong>DATETIME</strong></td>
                                <td>日付と時刻<br><small style="color: #666;">YYYY-MM-DD HH:MM:SS形式</small></td>
                                <td>作成日時、更新日時</td>
                                <td>'2024-01-15 14:30:00'</td>
                            </tr>
                            <tr>
                                <td><strong>BOOLEAN</strong></td>
                                <td>真偽値（はい/いいえ）<br><small style="color: #666;">TRUE/FALSE、1/0で表現</small></td>
                                <td>有効フラグ、削除フラグ</td>
                                <td>TRUE, FALSE</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div class="concept-box">
                        <h4>💡 データ型選びのポイント</h4>
                        <ul>
                            <li><strong>数値</strong>：計算するならINTやDECIMAL、しないなら文字列（電話番号など）</li>
                            <li><strong>文字列</strong>：最大長が分かるならVARCHAR、不明ならTEXT</li>
                            <li><strong>日付</strong>：時刻も必要ならDATETIME、日付だけならDATE</li>
                            <li><strong>真偽値</strong>：2択の項目にはBOOLEAN（例：有効/無効）</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- ストアドプロシージャ -->
            <div id="stored-proc" class="tab-content">
                <div class="section">
                    <h2>ストアドプロシージャ - 処理をまとめて保存</h2>
                    
                    <div class="concept-box">
                        <h3>ストアドプロシージャとは？</h3>
                        <p><span class="tooltip">ストアドプロシージャ<span class="tooltiptext">よく使うSQL文の集まりをデータベース内に名前を付けて保存しておく機能。プログラムの関数のように、何度でも呼び出して使える</span></span>は、よく使うSQL文の処理をまとめて、データベース内に保存しておく機能です。</p>
                        <p>プログラミングの「関数」のようなもので、名前を付けて何度でも呼び出せます。</p>
                    </div>
                    
                    <div class="code-highlight">
                        <span class="comment">-- ストアドプロシージャの作成例</span><br>
                        <span class="keyword">CREATE PROCEDURE</span> 部署別社員数取得<br>
                        <span class="keyword">AS</span><br>
                        <span class="keyword">BEGIN</span><br>
                        &nbsp;&nbsp;<span class="keyword">SELECT</span> 部署, <span class="keyword">COUNT</span>(*) <span class="keyword">AS</span> 社員数<br>
                        &nbsp;&nbsp;<span class="keyword">FROM</span> 社員<br>
                        &nbsp;&nbsp;<span class="keyword">GROUP BY</span> 部署<br>
                        &nbsp;&nbsp;<span class="keyword">ORDER BY</span> 社員数 <span class="keyword">DESC</span>;<br>
                        <span class="keyword">END</span>;<br><br>
                        
                        <span class="comment">-- ストアドプロシージャの実行</span><br>
                        <span class="keyword">EXEC</span> 部署別社員数取得;
                    </div>
                    
                    <div class="concept-box">
                        <h4>メリット</h4>
                        <ul>
                            <li>🚀 <strong>処理速度向上</strong>：事前にコンパイルされているため高速</li>
                            <li>🔒 <strong>セキュリティ向上</strong>：直接テーブルへのアクセスを制限できる</li>
                            <li>♻️ <strong>再利用性</strong>：一度作れば何度でも使える</li>
                            <li>🛠️ <strong>保守性向上</strong>：ビジネスロジックを一か所に集約</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- 実践シミュレータ -->
            <div id="simulator" class="tab-content">
                <div class="section">
                    <h2>SQL実践シミュレータ</h2>
                    
                    <div class="concept-box">
                        <h3>実際にSQLを書いて実行してみよう！</h3>
                        <p>下のエディタにSQL文を入力して、「実行」ボタンをクリックしてください。</p>
                        <p><strong>テーブル名は「社員」「部署」を使用してください。</strong></p>
                    </div>
                    
                    <!-- 現在のテーブル状態表示 -->
                    <div style="display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap;">
                        <div style="flex: 1; min-width: 300px;">
                            <h4>社員テーブル</h4>
                            <table class="data-table" id="employee-table">
                                <thead>
                                    <tr>
                                        <th>社員ID</th>
                                        <th>氏名</th>
                                        <th>部署</th>
                                        <th>入社日</th>
                                        <th>給与</th>
                                    </tr>
                                </thead>
                                <tbody id="employee-tbody">
                                    <!-- JavaScriptで動的に生成 -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="flex: 1; min-width: 300px;">
                            <h4>部署テーブル</h4>
                            <table class="data-table" id="department-table">
                                <thead>
                                    <tr>
                                        <th>部署コード</th>
                                        <th>部署名</th>
                                        <th>場所</th>
                                    </tr>
                                </thead>
                                <tbody id="department-tbody">
                                    <!-- JavaScriptで動的に生成 -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="sql-editor">
                        <textarea id="sql-input" class="sql-input" placeholder="ここにSQL文を入力してください。&#10;例: SELECT * FROM 社員;">SELECT * FROM 社員;</textarea>
                        <button class="execute-btn" onclick="executeSQL()">実行</button>
                        <button class="animation-btn" onclick="resetData()">データをリセット</button>
                    </div>
                    
                    <div id="result" class="result-area">
                        <p style="color: #666;">ここに実行結果が表示されます...</p>
                    </div>
                    
                    <h3>練習問題</h3>
                    <div class="example-card" onclick="loadExample('practice1')">
                        <strong>練習1:</strong> 全社員の氏名と給与を表示
                    </div>
                    
                    <div class="example-card" onclick="loadExample('practice2')">
                        <strong>練習2:</strong> 給与が30万円以上の社員を検索
                    </div>
                    
                    <div class="example-card" onclick="loadExample('practice3')">
                        <strong>練習3:</strong> 新入社員「加藤さん」を営業部に追加
                    </div>
                    
                    <div class="example-card" onclick="loadExample('practice4')">
                        <strong>練習4:</strong> 山田太郎さんの給与を35万円に更新
                    </div>
                    
                    <div class="example-card" onclick="loadExample('practice5')">
                        <strong>練習5:</strong> 営業部、開発部、企画部の社員を検索（IN句）
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // タブ切り替え機能
        function showTab(tabId) {
            // すべてのタブコンテンツを非表示
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // すべてのタブボタンから active クラスを削除
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            // 選択されたタブコンテンツを表示
            document.getElementById(tabId).classList.add('active');
            
            // 選択されたタブボタンに active クラスを追加
            const activeButton = Array.from(buttons).find(button => 
                button.onclick.toString().includes(tabId)
            );
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }
        
        // 初期データ
        let employees = [
            {社員ID: 'E001', 氏名: '山田太郎', 部署: '営業部', 入社日: '2020-04-01', 給与: 300000},
            {社員ID: 'E002', 氏名: '佐藤花子', 部署: '開発部', 入社日: '2019-10-01', 給与: 350000},
            {社員ID: 'E003', 氏名: '鈴木次郎', 部署: '人事部', 入社日: '2021-07-01', 給与: 280000},
            {社員ID: 'E004', 氏名: '田中美咲', 部署: '営業部', 入社日: '2022-04-01', 給与: 260000}
        ];
        
        let departments = [
            {部署コード: 'D01', 部署名: '営業部', 場所: '東京'},
            {部署コード: 'D02', 部署名: '開発部', 場所: '大阪'},
            {部署コード: 'D03', 部署名: '人事部', 場所: '東京'},
            {部署コード: 'D04', 部署名: '企画部', 場所: '名古屋'}
        ];
        
        // 初期データ表示
        function displayTables() {
            // 社員テーブル
            const empTbody = document.getElementById('employee-tbody');
            empTbody.innerHTML = '';
            employees.forEach(emp => {
                const row = `<tr>
                    <td>${emp.社員ID}</td>
                    <td>${emp.氏名}</td>
                    <td>${emp.部署}</td>
                    <td>${emp.入社日}</td>
                    <td>${emp.給与.toLocaleString()}</td>
                </tr>`;
                empTbody.innerHTML += row;
            });
            
            // 部署テーブル
            const deptTbody = document.getElementById('department-tbody');
            deptTbody.innerHTML = '';
            departments.forEach(dept => {
                const row = `<tr>
                    <td>${dept.部署コード}</td>
                    <td>${dept.部署名}</td>
                    <td>${dept.場所}</td>
                </tr>`;
                deptTbody.innerHTML += row;
            });
        }
        
        // SQL実行関数
        function executeSQL() {
            let sql = document.getElementById('sql-input').value.trim();
            const resultDiv = document.getElementById('result');
            
            // 末尾のセミコロンを削除
            if (sql.endsWith(';')) {
                sql = sql.slice(0, -1).trim();
            }
            
            if (!sql) {
                showError('SQL文を入力してください。');
                return;
            }
            
            try {
                // SQL文を解析して実行
                const result = parseSQLAndExecute(sql);
                showResult(result);
            } catch (error) {
                showError(error.message);
            }
        }
        
        // 簡易SQLパーサー
        function parseSQLAndExecute(sql) {
            const upperSQL = sql.toUpperCase();
            
            // SELECT文の処理
            if (upperSQL.startsWith('SELECT')) {
                return executeSelect(sql);
            }
            // INSERT文の処理
            else if (upperSQL.startsWith('INSERT')) {
                return executeInsert(sql);
            }
            // UPDATE文の処理
            else if (upperSQL.startsWith('UPDATE')) {
                return executeUpdate(sql);
            }
            // DELETE文の処理
            else if (upperSQL.startsWith('DELETE')) {
                return executeDelete(sql);
            }
            else {
                throw new Error('サポートされていないSQL文です。SELECT, INSERT, UPDATE, DELETE文を使用してください。');
            }
        }
        
        // SELECT文の実行
        function executeSelect(sql) {
            // JOIN句の処理
            if (sql.toUpperCase().includes(' JOIN ')) {
                return executeJoinSelect(sql);
            }
            
            // 通常のSELECT文の処理
            const match = sql.match(/SELECT\s+(.+?)\s+FROM\s+(\S+)(?:\s+WHERE\s+(.+))?/i);
            if (!match) {
                throw new Error('SELECT文の構文が正しくありません。');
            }
            
            const columns = match[1].trim();
            const tableName = match[2].trim();
            const whereClause = match[3];
            
            // テーブル選択
            let data;
            if (tableName === '社員' || tableName.toLowerCase() === 'employees') {
                data = [...employees];
            } else if (tableName === '部署' || tableName.toLowerCase() === 'departments') {
                data = [...departments];
            } else {
                throw new Error(`テーブル '${tableName}' が見つかりません。「社員」または「部署」を使用してください。`);
            }
            
            // WHERE句の処理
            if (whereClause) {
                data = applyWhereClause(data, whereClause);
            }
            
            // カラムの選択
            if (columns !== '*') {
                const columnList = columns.split(',').map(c => c.trim());
                data = data.map(row => {
                    const newRow = {};
                    columnList.forEach(col => {
                        if (row.hasOwnProperty(col)) {
                            newRow[col] = row[col];
                        }
                    });
                    return newRow;
                });
            }
            
            return {
                type: 'SELECT',
                data: data,
                message: `${data.length}件のレコードが見つかりました。`
            };
        }
        
        // JOIN付きSELECT文の実行
        function executeJoinSelect(sql) {
            // 簡易的なJOINパース
            const match = sql.match(/SELECT\s+(.+?)\s+FROM\s+(\S+)\s+JOIN\s+(\S+)\s+ON\s+(.+?)(?:\s+WHERE\s+(.+))?$/i);
            if (!match) {
                throw new Error('JOIN文の構文が正しくありません。');
            }
            
            const columns = match[1].trim();
            const table1Name = match[2].trim();
            const table2Name = match[3].trim();
            const joinCondition = match[4].trim();
            const whereClause = match[5];
            
            // テーブル取得
            let table1, table2;
            if (table1Name === '社員') {
                table1 = [...employees];
            } else {
                throw new Error(`テーブル '${table1Name}' が見つかりません。`);
            }
            
            if (table2Name === '部署') {
                table2 = [...departments];
            } else {
                throw new Error(`テーブル '${table2Name}' が見つかりません。`);
            }
            
            // JOIN条件の解析（簡易版）
            const [left, right] = joinCondition.split('=').map(s => s.trim());
            const [leftTable, leftColumn] = left.includes('.') ? left.split('.') : [table1Name, left];
            const [rightTable, rightColumn] = right.includes('.') ? right.split('.') : [table2Name, right];
            
            // INNER JOINの実行
            const joinedData = [];
            table1.forEach(row1 => {
                table2.forEach(row2 => {
                    // 部署名と部署コードの特殊処理
                    let match = false;
                    if (leftColumn === '部署' && rightColumn === '部署名') {
                        match = row1[leftColumn] === row2[rightColumn];
                    } else if (leftColumn === '部署コード' && rightColumn === '部署コード') {
                        match = row1[leftColumn] === row2[rightColumn];
                    } else {
                        match = row1[leftColumn] === row2[rightColumn];
                    }
                    
                    if (match) {
                        const joinedRow = { ...row1 };
                        // 重複しないカラムを追加
                        Object.keys(row2).forEach(key => {
                            if (!joinedRow.hasOwnProperty(key)) {
                                joinedRow[key] = row2[key];
                            }
                        });
                        joinedData.push(joinedRow);
                    }
                });
            });
            
            // WHERE句の処理
            let data = joinedData;
            if (whereClause) {
                data = applyWhereClause(data, whereClause);
            }
            
            // カラムの選択
            if (columns !== '*') {
                const columnList = columns.split(',').map(c => c.trim());
                data = data.map(row => {
                    const newRow = {};
                    columnList.forEach(col => {
                        // テーブル名.カラム名の形式に対応
                        if (col.includes('.')) {
                            const [table, column] = col.split('.');
                            if (row.hasOwnProperty(column)) {
                                newRow[column] = row[column];
                            }
                        } else if (row.hasOwnProperty(col)) {
                            newRow[col] = row[col];
                        }
                    });
                    return newRow;
                });
            }
            
            return {
                type: 'SELECT',
                data: data,
                message: `JOIN結果: ${data.length}件のレコードが見つかりました。`
            };
        }
        
        // WHERE句の適用
        function applyWhereClause(data, whereClause) {
            // OR条件の処理
            if (whereClause.toUpperCase().includes(' OR ')) {
                const orConditions = whereClause.split(/\s+OR\s+/i);
                return data.filter(row => {
                    return orConditions.some(condition => evaluateSingleCondition(row, condition.trim()));
                });
            }
            
            // AND条件の処理
            const conditions = whereClause.split(/\s+AND\s+/i);
            return data.filter(row => {
                return conditions.every(condition => evaluateSingleCondition(row, condition.trim()));
            });
        }
        
        // 単一条件の評価
        function evaluateSingleCondition(row, condition) {
            // NOT演算子の処理
            if (condition.toUpperCase().startsWith('NOT ')) {
                const innerCondition = condition.substring(4).trim();
                return !evaluateSingleCondition(row, innerCondition);
            }
            
            // IN演算子の処理
            if (condition.toUpperCase().includes(' IN ')) {
                const match = condition.match(/(\S+)\s+IN\s*\(([^)]+)\)/i);
                if (match) {
                    const column = match[1].trim();
                    const values = match[2].split(',').map(v => v.trim().replace(/['"]/g, ''));
                    return values.includes(row[column]);
                }
            }
            
            // = 演算子の処理
            if (condition.includes('=') && !condition.includes('>=') && !condition.includes('<=') && !condition.includes('!=')) {
                const [column, value] = condition.split('=').map(s => s.trim());
                const cleanValue = value.replace(/['"]/g, '');
                
                if (column === '給与' && !isNaN(cleanValue)) {
                    return row[column] == parseInt(cleanValue);
                }
                return row[column] == cleanValue;
            }
            // != 演算子の処理
            else if (condition.includes('!=')) {
                const [column, value] = condition.split('!=').map(s => s.trim());
                const cleanValue = value.replace(/['"]/g, '');
                return row[column] != cleanValue;
            }
            // >= 演算子の処理
            else if (condition.includes('>=')) {
                const [column, value] = condition.split('>=').map(s => s.trim());
                return row[column] >= parseInt(value);
            }
            // <= 演算子の処理
            else if (condition.includes('<=')) {
                const [column, value] = condition.split('<=').map(s => s.trim());
                return row[column] <= parseInt(value);
            }
            // > 演算子の処理
            else if (condition.includes('>')) {
                const [column, value] = condition.split('>').map(s => s.trim());
                return row[column] > parseInt(value);
            }
            // < 演算子の処理
            else if (condition.includes('<')) {
                const [column, value] = condition.split('<').map(s => s.trim());
                return row[column] < parseInt(value);
            }
            
            return true;
        }
        
        // INSERT文の実行
        function executeInsert(sql) {
            const match = sql.match(/INSERT\s+INTO\s+(\S+)\s*\(([^)]+)\)\s*VALUES\s*\(([^)]+)\)/i);
            if (!match) {
                throw new Error('INSERT文の構文が正しくありません。');
            }
            
            const tableName = match[1].trim();
            const columns = match[2].split(',').map(c => c.trim());
            const values = match[3].split(',').map(v => v.trim().replace(/['"]/g, ''));
            
            if (tableName !== '社員') {
                throw new Error('このシミュレータでは社員テーブルへの挿入のみサポートしています。');
            }
            
            const newRecord = {};
            columns.forEach((col, index) => {
                if (col === '給与') {
                    newRecord[col] = parseInt(values[index]);
                } else {
                    newRecord[col] = values[index];
                }
            });
            
            employees.push(newRecord);
            displayTables();
            
            return {
                type: 'INSERT',
                message: '1件のレコードを追加しました。'
            };
        }
        
        // UPDATE文の実行
        function executeUpdate(sql) {
            const match = sql.match(/UPDATE\s+(\S+)\s+SET\s+(.+?)\s+WHERE\s+(.+)/i);
            if (!match) {
                throw new Error('UPDATE文の構文が正しくありません。WHERE句は必須です。');
            }
            
            const tableName = match[1].trim();
            const setClause = match[2].trim();
            const whereClause = match[3].trim();
            
            if (tableName !== '社員') {
                throw new Error('このシミュレータでは社員テーブルの更新のみサポートしています。');
            }
            
            // SET句の解析
            const [column, value] = setClause.split('=').map(s => s.trim());
            const cleanValue = value.replace(/['"]/g, '');
            
            // 更新対象の検索
            let updateCount = 0;
            employees.forEach(emp => {
                if (evaluateWhereCondition(emp, whereClause)) {
                    if (column === '給与') {
                        emp[column] = parseInt(cleanValue);
                    } else {
                        emp[column] = cleanValue;
                    }
                    updateCount++;
                }
            });
            
            displayTables();
            
            return {
                type: 'UPDATE',
                message: `${updateCount}件のレコードを更新しました。`
            };
        }
        
        // DELETE文の実行
        function executeDelete(sql) {
            const match = sql.match(/DELETE\s+FROM\s+(\S+)\s+WHERE\s+(.+)/i);
            if (!match) {
                throw new Error('DELETE文の構文が正しくありません。WHERE句は必須です。');
            }
            
            const tableName = match[1].trim();
            const whereClause = match[2].trim();
            
            if (tableName !== '社員') {
                throw new Error('このシミュレータでは社員テーブルの削除のみサポートしています。');
            }
            
            const originalLength = employees.length;
            employees = employees.filter(emp => !evaluateWhereCondition(emp, whereClause));
            const deleteCount = originalLength - employees.length;
            
            displayTables();
            
            return {
                type: 'DELETE',
                message: `${deleteCount}件のレコードを削除しました。`
            };
        }
        
        // WHERE条件の評価
        function evaluateWhereCondition(row, condition) {
            return evaluateSingleCondition(row, condition);
        }
        
        // 結果表示
        function showResult(result) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result-area result-success';
            
            if (result.type === 'SELECT' && result.data.length > 0) {
                // テーブル形式で表示
                const columns = Object.keys(result.data[0]);
                let html = `<p>${result.message}</p><table class="data-table"><thead><tr>`;
                
                columns.forEach(col => {
                    html += `<th>${col}</th>`;
                });
                html += '</tr></thead><tbody>';
                
                result.data.forEach(row => {
                    html += '<tr>';
                    columns.forEach(col => {
                        const value = col === '給与' && typeof row[col] === 'number' 
                            ? row[col].toLocaleString() 
                            : row[col];
                        html += `<td>${value}</td>`;
                    });
                    html += '</tr>';
                });
                
                html += '</tbody></table>';
                resultDiv.innerHTML = html;
            } else {
                resultDiv.innerHTML = `<p style="color: var(--success-color); font-weight: bold;">✓ ${result.message}</p>`;
            }
        }
        
        // エラー表示
        function showError(message) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result-area result-error';
            resultDiv.innerHTML = `<p style="color: var(--danger-color); font-weight: bold;">❌ エラー: ${message}</p>`;
        }
        
        // データリセット
        function resetData() {
            employees = [
                {社員ID: 'E001', 氏名: '山田太郎', 部署: '営業部', 入社日: '2020-04-01', 給与: 300000},
                {社員ID: 'E002', 氏名: '佐藤花子', 部署: '開発部', 入社日: '2019-10-01', 給与: 350000},
                {社員ID: 'E003', 氏名: '鈴木次郎', 部署: '人事部', 入社日: '2021-07-01', 給与: 280000},
                {社員ID: 'E004', 氏名: '田中美咲', 部署: '営業部', 入社日: '2022-04-01', 給与: 260000}
            ];
            displayTables();
            showResult({type: 'RESET', message: 'データを初期状態にリセットしました。'});
        }
        
        // 例題ロード
        function loadExample(exampleId) {
            const sqlInput = document.getElementById('sql-input');
            const examples = {
                'select1': 'SELECT 氏名, 部署 FROM 社員;',
                'select2': 'SELECT * FROM 社員 WHERE 給与 >= 300000;',
                'insert1': "INSERT INTO 社員 (社員ID, 氏名, 部署, 入社日, 給与) VALUES ('E006', '伊藤真理', '人事部', '2024-01-01', 270000);",
                'update1': "UPDATE 社員 SET 部署 = '企画部' WHERE 氏名 = '山田太郎';",
                'delete1': "DELETE FROM 社員 WHERE 社員ID = 'E999';",
                'where1': "SELECT * FROM 社員 WHERE 部署 = '営業部' AND 給与 >= 300000;",
                'where2': "SELECT * FROM 社員 WHERE 部署 = '営業部' OR 部署 = '開発部';",
                'where3': "SELECT * FROM 社員 WHERE 部署 IN ('営業部', '開発部', '企画部');",
                'join1': "SELECT 社員.氏名, 社員.部署, 部署.場所 FROM 社員 JOIN 部署 ON 社員.部署 = 部署.部署名;",
                'practice1': 'SELECT 氏名, 給与 FROM 社員;',
                'practice2': 'SELECT * FROM 社員 WHERE 給与 >= 300000;',
                'practice3': "INSERT INTO 社員 (社員ID, 氏名, 部署, 入社日, 給与) VALUES ('E007', '加藤健太', '営業部', '2024-04-01', 250000);",
                'practice4': "UPDATE 社員 SET 給与 = 350000 WHERE 氏名 = '山田太郎';",
                'practice5': "SELECT * FROM 社員 WHERE 部署 IN ('営業部', '開発部', '企画部');"
            };
            
            if (examples[exampleId]) {
                sqlInput.value = examples[exampleId];
                
                // シミュレータタブに切り替え
                showTab('simulator');
                
                // SQLエディタまでスクロール
                sqlInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
                sqlInput.focus();
            }
        }
        
        // トランザクションアニメーション
        function animateTransaction(type) {
            const steps = document.querySelectorAll('.transaction-step');
            steps.forEach(step => {
                step.classList.remove('active', 'success', 'error');
            });
            
            if (type === 'success') {
                // 成功パターン
                let currentStep = 0;
                const interval = setInterval(() => {
                    if (currentStep < steps.length) {
                        steps[currentStep].classList.add('active');
                        if (currentStep === steps.length - 1) {
                            setTimeout(() => {
                                steps.forEach(step => step.classList.add('success'));
                            }, 500);
                        }
                        currentStep++;
                    } else {
                        clearInterval(interval);
                    }
                }, 1000);
            } else {
                // 失敗パターン
                steps[0].classList.add('active');
                setTimeout(() => {
                    steps[1].classList.add('active');
                }, 1000);
                setTimeout(() => {
                    steps[2].classList.add('active', 'error');
                    setTimeout(() => {
                        alert('エラー発生！すべての処理をロールバック（取り消し）します。');
                        steps.forEach(step => {
                            step.classList.remove('active', 'success');
                            step.classList.add('error');
                        });
                    }, 500);
                }, 2000);
            }
        }
        
        // 初期化
        window.addEventListener('load', () => {
            displayTables();
        });
        
        // テーブル構造アニメーション
        function animateTableStructure() {
            const steps = ['step1', 'step2', 'step3', 'step4'];
            let currentStep = 0;
            
            // すべてのステップを非アクティブに
            steps.forEach(id => {
                document.getElementById(id).classList.remove('active', 'completed');
            });
            
            // SVG要素の取得
            const tableFrame = document.getElementById('table-frame');
            const columnIndicator = document.getElementById('column-indicator');
            const recordIndicator = document.getElementById('record-indicator');
            const rows = document.querySelectorAll('.record-row');
            const cellHighlight = document.getElementById('cell-highlight');
            
            // 初期状態
            columnIndicator.style.opacity = '0';
            recordIndicator.style.opacity = '0';
            cellHighlight.style.opacity = '0';
            rows.forEach(row => row.classList.remove('structure-highlight'));
            
            const animateStep = () => {
                if (currentStep < steps.length) {
                    // 現在のステップをアクティブに
                    document.getElementById(steps[currentStep]).classList.add('active');
                    
                    switch(currentStep) {
                        case 0: // Table全体
                            tableFrame.classList.add('structure-highlight');
                            break;
                        case 1: // Column
                            tableFrame.classList.remove('structure-highlight');
                            columnIndicator.style.opacity = '1';
                            columnIndicator.style.transition = 'opacity 0.5s ease';
                            break;
                        case 2: // Record
                            columnIndicator.style.opacity = '0';
                            recordIndicator.style.opacity = '1';
                            recordIndicator.style.transition = 'opacity 0.5s ease';
                            document.getElementById('row2').classList.add('structure-highlight');
                            break;
                        case 3: // Cell
                            recordIndicator.style.opacity = '0';
                            document.getElementById('row2').classList.remove('structure-highlight');
                            cellHighlight.style.opacity = '0.5';
                            cellHighlight.style.transition = 'opacity 0.5s ease';
                            break;
                    }
                    
                    // 完了マーク
                    if (currentStep > 0) {
                        document.getElementById(steps[currentStep - 1]).classList.add('completed');
                    }
                    
                    currentStep++;
                    setTimeout(animateStep, 2000);
                } else {
                    // 最後のステップも完了に
                    document.getElementById(steps[steps.length - 1]).classList.add('completed');
                    
                    // リセット
                    setTimeout(() => {
                        cellHighlight.style.opacity = '0';
                        tableFrame.classList.remove('structure-highlight');
                    }, 1000);
                }
            };
            
            animateStep();
        }
        
        // SELECT文フローアニメーション
        function animateSelectFlow() {
            let currentStep = 1;
            const totalSteps = 5;
            
            // 初期化
            resetSelectAnimation();
            
            const animateStep = () => {
                const stepBox = document.getElementById('step-box');
                const stepText = document.getElementById('step-text');
                
                switch(currentStep) {
                    case 1:
                        // ステップ1: テーブル全体を表示
                        stepText.textContent = 'ステップ 1: テーブル全体を確認';
                        stepBox.classList.remove('step2', 'step3', 'step4', 'step5');
                        break;
                        
                    case 2:
                        // ステップ2: WHERE句の条件を確認
                        stepText.textContent = 'ステップ 2: WHERE句の条件（部署 = \'営業部\'）を確認';
                        stepBox.classList.add('step2');
                        document.getElementById('where-condition').style.opacity = '1';
                        
                        // 部署列をハイライト
                        document.getElementById('col-dept').classList.add('active');
                        break;
                        
                    case 3:
                        // ステップ3: 条件に合うレコードを特定
                        stepText.textContent = 'ステップ 3: 条件に合うRecord（営業部の社員）を特定';
                        stepBox.classList.remove('step2');
                        stepBox.classList.add('step3');
                        
                        // 営業部以外をフェード
                        document.getElementById('select-row2').classList.add('fade');
                        document.getElementById('select-row3').classList.add('fade');
                        
                        // 営業部のレコードをハイライト
                        document.getElementById('select-row1').classList.add('match');
                        document.getElementById('select-row4').classList.add('match');
                        break;
                        
                    case 4:
                        // ステップ4: SELECT句で指定された列を選択
                        stepText.textContent = 'ステップ 4: SELECT句で指定されたColumn（氏名、給与）を選択';
                        stepBox.classList.remove('step3');
                        stepBox.classList.add('step4');
                        
                        document.getElementById('select-columns').style.opacity = '1';
                        
                        // 不要な列をフェード
                        document.getElementById('col-id').style.opacity = '0.3';
                        document.getElementById('col-dept').style.opacity = '0.3';
                        document.getElementById('col-date').style.opacity = '0.3';
                        
                        // 必要な列をハイライト
                        document.getElementById('col-name').classList.add('active');
                        document.getElementById('col-salary').classList.add('active');
                        break;
                        
                    case 5:
                        // ステップ5: 最終結果を表示
                        stepText.textContent = 'ステップ 5: 最終的なCell（値）を取得して結果を表示';
                        stepBox.classList.remove('step4');
                        stepBox.classList.add('step5');
                        
                        // 結果を表示
                        document.getElementById('result-area').style.opacity = '1';
                        break;
                }
                
                currentStep++;
                if (currentStep <= totalSteps) {
                    setTimeout(animateStep, 2000);
                }
            };
            
            animateStep();
        }
        
        // SELECT文アニメーションのリセット
        function resetSelectAnimation() {
            const stepBox = document.getElementById('step-box');
            const stepText = document.getElementById('step-text');
            
            stepBox.classList.remove('step2', 'step3', 'step4', 'step5');
            stepText.textContent = 'ステップ 1: テーブル全体を確認';
            
            // 要素の状態をリセット
            document.getElementById('where-condition').style.opacity = '0';
            document.getElementById('select-columns').style.opacity = '0';
            document.getElementById('result-area').style.opacity = '0';
            
            // 列のハイライトをリセット
            document.querySelectorAll('.column-highlight').forEach(el => {
                el.classList.remove('active');
                el.style.opacity = '1';
            });
            
            // 行のハイライトをリセット
            document.querySelectorAll('.select-record').forEach(el => {
                el.classList.remove('fade', 'highlight', 'match');
            });
        }
        
        // アニメーションリセット
        function resetAnimation() {
            const steps = ['step1', 'step2', 'step3', 'step4'];
            steps.forEach(id => {
                document.getElementById(id).classList.remove('active', 'completed');
            });
            document.getElementById('step1').classList.add('active');
            
            // SVG要素のリセット
            document.getElementById('column-indicator').style.opacity = '0';
            document.getElementById('record-indicator').style.opacity = '0';
            document.getElementById('cell-highlight').style.opacity = '0';
            document.getElementById('table-frame').classList.remove('structure-highlight');
            document.querySelectorAll('.record-row').forEach(row => {
                row.classList.remove('structure-highlight');
            });
        }
        
        // 階層構造アニメーション
        function animateHierarchy() {
            let currentStep = 0;
            const steps = [
                {
                    element: 'dbms-layer',
                    cells: [],
                    description: 'DBMS全体 - すべてのデータベースを管理'
                },
                {
                    element: 'database-layer',
                    cells: [],
                    description: 'Database層 - 業務ごとのデータベース'
                },
                {
                    element: 'table-layer',
                    cells: [],
                    description: 'Table層 - データを格納する表'
                },
                {
                    element: 'record1',
                    cells: ['cell-e001', 'cell-yamada', 'cell-eigyo1', 'cell-300k'],
                    description: 'Record（行） - 1件分の完全なデータ'
                },
                {
                    element: null,
                    cells: ['cell-yamada'],
                    description: 'Cell（セル） - 行と列が交差する個々の値'
                }
            ];
            
            // 初期化
            document.querySelectorAll('.data-cell').forEach(cell => {
                cell.classList.remove('highlight');
            });
            document.querySelectorAll('.data-record').forEach(record => {
                record.classList.remove('highlight');
            });
            
            const animateStep = () => {
                if (currentStep > 0) {
                    // 前のステップのハイライトを解除
                    const prevStep = steps[currentStep - 1];
                    if (prevStep.element) {
                        const prevEl = document.getElementById(prevStep.element);
                        if (prevEl) {
                            prevEl.style.filter = '';
                            prevEl.style.opacity = '';
                        }
                    }
                    prevStep.cells.forEach(cellId => {
                        const cell = document.getElementById(cellId);
                        if (cell) cell.classList.remove('highlight');
                    });
                }
                
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    
                    // 要素をハイライト
                    if (step.element) {
                        const el = document.getElementById(step.element);
                        if (el) {
                            el.style.filter = 'drop-shadow(0 0 20px rgba(255, 150, 28, 0.8))';
                            el.style.opacity = '1';
                        }
                    }
                    
                    // セルをハイライト
                    step.cells.forEach(cellId => {
                        const cell = document.getElementById(cellId);
                        if (cell) cell.classList.add('highlight');
                    });
                    
                    currentStep++;
                    setTimeout(animateStep, 2000);
                } else {
                    // アニメーション終了後にリセット
                    setTimeout(() => {
                        steps.forEach(step => {
                            if (step.element) {
                                const el = document.getElementById(step.element);
                                if (el) {
                                    el.style.filter = '';
                                    el.style.opacity = '';
                                }
                            }
                            step.cells.forEach(cellId => {
                                const cell = document.getElementById(cellId);
                                if (cell) cell.classList.remove('highlight');
                            });
                        });
                    }, 1000);
                }
            };
            
            animateStep();
        }

        // ツールチップ位置調整機能（fixed position版）
        function adjustTooltipPosition() {
            const tooltips = document.querySelectorAll('.tooltip');
            
            tooltips.forEach(tooltip => {
                const tooltipText = tooltip.querySelector('.tooltiptext');
                if (!tooltipText) return;

                tooltip.addEventListener('mouseenter', () => {
                    const triggerRect = tooltip.getBoundingClientRect();
                    const viewportWidth = window.innerWidth;
                    const tooltipWidth = 280;
                    
                    // 基本的な位置計算（trigger要素の上部中央）
                    let left = triggerRect.left + triggerRect.width / 2 - tooltipWidth / 2;
                    let top = triggerRect.top - 10; // ツールチップの上端
                    
                    // 左端からのはみ出しチェック
                    if (left < 20) {
                        left = 20;
                    }
                    // 右端からのはみ出しチェック
                    else if (left + tooltipWidth > viewportWidth - 20) {
                        left = viewportWidth - tooltipWidth - 20;
                    }
                    
                    // 上端からのはみ出しチェック（下に表示）
                    if (top < 20) {
                        top = triggerRect.bottom + 10;
                    }
                    
                    // 位置を設定
                    tooltipText.style.left = left + 'px';
                    tooltipText.style.top = top + 'px';
                    tooltipText.style.transform = 'none';
                    tooltipText.style.visibility = 'visible';
                    tooltipText.style.opacity = '1';
                });

                tooltip.addEventListener('mouseleave', () => {
                    tooltipText.style.visibility = 'hidden';
                    tooltipText.style.opacity = '0';
                });
            });
        }

        // DOM読み込み完了後に実行
        document.addEventListener('DOMContentLoaded', () => {
            adjustTooltipPosition();
        });

        // ウィンドウサイズ変更時にも再調整
        window.addEventListener('resize', adjustTooltipPosition);
    </script>
</body>
</html>